import gradio as gr
import os
os.environ["PYTORCH_SDP_DISABLE_FLASH_ATTN"] = "1"
os.environ["PYTORCH_ENABLE_SDPA"] = "0"

import io
import time
import re
import sys
import cv2
import subprocess
from moviepy.video.io.VideoFileClip import VideoFileClip
from moviepy.audio.io.AudioFileClip import AudioFileClip
import torch
torch.backends.cuda.enable_flash_sdp(False)
torch.backends.cuda.enable_math_sdp(True)
torch.backends.cuda.enable_mem_efficient_sdp(False)

from contextlib import redirect_stdout
from pathlib import Path

from src import constants
from scripts.action.predict import predict_single_video
from src.vlm.vlm_utils import get_key_actions, extract_video_clips, describe_actions
from src.vlm.llm_utils import generate_commentary

sys.path.append(os.path.abspath("src"))
sys.path.append(os.path.abspath("src/zonos"))
from zonos.sample import generate_audio_commentary



VIDEO_DIRECTORY = "./data/soccernet/action-spotting-2023"


def list_folders():
    """Liste les dossiers disponibles contenant des vidéos"""
    folders = [f for f in os.listdir(VIDEO_DIRECTORY) if os.path.isdir(os.path.join(VIDEO_DIRECTORY, f))]
    return folders

def list_videos_in_folder(folder_name):
    """Liste les vidéos dans le dossier sélectionné"""
    if folder_name is None or folder_name == "Aucun dossier disponible":
        return gr.update(choices=[], value=None)  # Pas de vidéos sélectionnables

    folder_path = os.path.join(VIDEO_DIRECTORY, folder_name)

    if not os.path.exists(folder_path):  # Vérifie que le dossier existe
        return gr.update(choices=[], value=None)

    videos = [f for f in os.listdir(folder_path) if f.endswith(('.mp4', '.avi', '.mov', '.mkv'))]

    if videos:
        return gr.update(choices=videos, value=videos[0])  # Met la première vidéo par défaut
    else:
        return gr.update(choices=[], value=None)  # Aucune vidéo trouvée


def merge_video_with_audio(video_path: str, audio_path: str, output_path: str):
    """
    Merges a video (.mp4) with an audio commentary (.mp3) and saves the result.
    If the original video has no audio stream, it first adds a silent track.

    Args:
        video_path (str): Path to the original video file.
        audio_path (str): Path to the corresponding audio commentary (.mp3).
        output_path (str): Path where the final video will be saved.

    Returns:
        str: Path to the saved merged video.
    """
    os.makedirs(os.path.dirname(output_path), exist_ok=True)  # Ensure output folder exists

    # If the video has no audio, add a silent track
    merge_cmd = [
        "ffmpeg",
        "-y",  # Overwrite if exists
        "-i", video_path,  # Input video
        "-i", audio_path,  # Input audio
        #"-c:a", "aac",
        #"-acodec", "copy",
        #"-vcodec", "copy",
        "-c:v", "libx264",        # Re-encode video to H.264
        "-c:a", "aac",             # Re-encode audio to AAC
        "-shortest",
        output_path
    ]

    try:
        subprocess.run(merge_cmd, check=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE)
        print(f"✅ Merged: {video_path} + {audio_path} → {output_path}")
        return output_path
    except subprocess.CalledProcessError as e:
        print(f"❌ Error merging {video_path} and {audio_path}:\n{e.stderr.decode()}")
        return None


def convert_wav_to_mp3(input_wav: str, output_mp3: str, bitrate="192k"):
    """
    Converts a WAV file to MP3 using FFmpeg.
    Args:
        input_wav (str): Path to the input WAV file.
        output_mp3 (str): Path to the output MP3 file.
        bitrate (str, optional): Bitrate for the MP3 file (default: 192k).
    Returns:
        str: Path to the converted MP3 file, or None if an error occurred.
    """
    command = [
        "ffmpeg",
        "-i", input_wav,  # Input WAV file
        "-c:a", "libmp3lame",  # Use LAME MP3 encoder
        "-b:a", bitrate,  # Set audio bitrate
        output_mp3  # Output MP3 file
    ]

    try:
        subprocess.run(command, check=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE)
        print(f"✅ Converted: {input_wav} → {output_mp3}")
        return output_mp3
    except subprocess.CalledProcessError as e:
        print(f"❌ Error converting {input_wav} to {output_mp3}:\n{e.stderr.decode()}")
        return None


def merge_all_videos_with_audio(CLIPS_DIR, COMMENTARY_DIR, OUTPUT_DIR):
    """
    Merges all videos in `data/clips/` with their corresponding audio commentaries in `data/clips/commentary/`
    and saves them in `data/commented_clips/`.
    """
    # Define paths
    #BASE_DIR = os.path.abspath(os.path.join(os.path.dirname(__file__)))
    #CLIPS_DIR = os.path.join(BASE_DIR, "data/clips")
    #COMMENTARY_DIR = os.path.join(CLIPS_DIR, "commentary")
    #OUTPUT_DIR = os.path.join(BASE_DIR, "data/commented_clips")
    
    os.makedirs(OUTPUT_DIR, exist_ok=True)  # Ensure output folder exists

    # Convert all WAV files to MP3
    for audio_file in os.listdir(COMMENTARY_DIR):
        if audio_file.endswith(".wav"):
            wav_path = os.path.join(COMMENTARY_DIR, audio_file)
            mp3_path = os.path.join(COMMENTARY_DIR, os.path.splitext(audio_file)[0] + ".mp3")
            if not os.path.exists(mp3_path):  # Convert only if MP3 doesn't exist
                convert_wav_to_mp3(wav_path, mp3_path)

    # Process each video in `data/clips/`
    for video_file in os.listdir(CLIPS_DIR):
        if video_file.endswith(".mp4"):
            video_path = os.path.join(CLIPS_DIR, video_file)
            audio_path = os.path.join(COMMENTARY_DIR, os.path.splitext(video_file)[0] + ".mp3")
            output_path = os.path.join(OUTPUT_DIR, video_file) #video_file.split(".")[0]+".mkv")  # Save with same name but in `commented_clips/`

            # Ensure the corresponding audio exists
            if os.path.exists(audio_path):
                merge_video_with_audio(video_path, audio_path, output_path)
            else:
                print(f"⚠ No matching audio found for {video_file}. Skipping.")
    

def full_pipeline(folder_name, video_name, video_prediction=False, clip_extraction=False, use_tracking=True, generate_description=False, generate_commentary=False, generate_audio=False):
    
    experiment, split = "action_sampling_weights_002", "test"
    game = folder_name + "/" + video_name
    constants.test_games = [game]
    prediction_dir = os.path.join("data", "app_test", "action/")

    clips_dir=os.path.join(prediction_dir, game, "clips")
    commentary_dir=os.path.join(prediction_dir, game, "clips_tracked", "commentary")
    output_dir=os.path.join(prediction_dir, game, "clips_commented")

    ######################### ACTION SPOTTING #############################
    yield "Running Action Spotting model on video...", [], {}, {}
    if video_prediction:
        predict_single_video(experiment, split, 0, False, Path(prediction_dir), constants)
    else:
        time.sleep(10)

    ########################## CLIP EXTRACTION ############################
    actions = get_key_actions(game, confidence_threshold=0.7)
    yield f"Action Spotting completed, {len(actions)} key actions were identified! Extraction of the highlight clips...", [], {}, {}
    if clip_extraction:
        original_clips = extract_video_clips(os.path.join(VIDEO_DIRECTORY, game), actions, clips_dir, clip_length=10)
    else:
        time.sleep(5)
        original_clips = [{'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_0_Corner.mp4', 'label': 'Corner', 'gameTime': '1 - 00:37'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_4_Throw-in.mp4', 'label': 'Throw-in', 'gameTime': '1 - 01:34'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_6_Throw-in.mp4', 'label': 'Throw-in', 'gameTime': '1 - 01:52'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_7_Goal.mp4', 'label': 'Goal', 'gameTime': '1 - 02:07'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_8_Substitution.mp4', 'label': 'Substitution', 'gameTime': '1 - 02:11'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_9_Throw-in.mp4', 'label': 'Throw-in', 'gameTime': '1 - 03:40'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_10_Foul.mp4', 'label': 'Foul', 'gameTime': '1 - 04:31'}, 
        {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_12_Throw-in.mp4', 'label': 'Throw-in', 'gameTime': '1 - 06:21'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_13_Foul.mp4', 'label': 'Foul', 'gameTime': '1 - 06:33'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_14_Foul.mp4', 'label': 'Foul', 'gameTime': '1 - 06:41'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_15_Goal.mp4', 'label': 'Goal', 'gameTime': '1 - 07:48'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_16_Clearance.mp4', 'label': 'Clearance', 'gameTime': '1 - 08:44'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_17_Clearance.mp4', 'label': 'Clearance', 'gameTime': '1 - 08:46'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_18_Kick-off.mp4', 'label': 'Kick-off', 'gameTime': '1 - 09:17'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_20_Clearance.mp4', 'label': 'Clearance', 'gameTime': '1 - 10:05'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_21_Foul.mp4', 'label': 'Foul', 'gameTime': '1 - 11:00'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_22_Substitution.mp4', 'label': 'Substitution', 'gameTime': '1 - 11:06'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_23_Substitution.mp4', 'label': 'Substitution', 'gameTime': '1 - 11:08'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_24_Substitution.mp4', 'label': 'Substitution', 'gameTime': '1 - 11:39'}]
    
    ######################## CLIP MAPPING ################################
    if use_tracking:
        clips = [{"path": clip["path"].replace("clips", "clips_tracked"), "label": clip["label"], "gameTime": clip["gameTime"]} for clip in original_clips]
    else:
        clips = original_clips

    clip_choices = [f"{clip['gameTime']} {clip['label']}" for clip in original_clips]
    clip_mapping = {f"{clip['gameTime']} {clip['label']}": clip["path"].replace("clips", "clips_commented") for clip in original_clips}
    print(clip_mapping)
    yield f"Highlight clips extracted! Generating AI descriptions...", gr.update(choices=clip_choices, value=clip_choices[0] if clip_choices else None, visible=True), {}, {}
    
    ###################### DESCRIPTION GENERATION #######################
    match_context = "It's a Premier League match between Tottenham and Chelsea. Tottenham plays with white jerseys, and Chelsea plays with dark blue jerseys."
    if generate_description:
        descriptions = describe_actions(clips, clip_length=10, use_tracking=True)
    else:
        descriptions = DESCRIPTIONS_OUTPUT
        time.sleep(8)
    
    # descriptions dictionary has the format: descriptions[clip["path"]] = {"timestamp": clip["gameTime"], "label": clip["label"], "description": description}
    yield f"AI Descriptions generated! Now we reformulate them into natural sport commentaries...", gr.update(choices=clip_choices, value=clip_choices[0] if clip_choices else None, visible=True), {}, {}
    ################### TEXTUAL COMMENTARY ###########################
    if generate_commentary:
        results = generate_commentary(descriptions, match_context)
    else:
        results = RESULTS_OUTPUT
        time.sleep(8)

    yield f"Textual commentaries generated! Now generating audio commentaries and merging with the video clips...", gr.update(choices=clip_choices, value=clip_choices[0] if clip_choices else None, visible=True), {}, {}
    if generate_audio:
        for clip in clips:
            clip_path= clip["path"]
            generate_audio_commentary(clip_path, results[clip_path]["Generated Commentary"], clip['label'])
            merge_all_videos_with_audio(CLIPS_DIR=clips_dir, COMMENTARY_DIR=commentary_dir, OUTPUT_DIR=output_dir)
        
    else:   
        time.sleep(8)
        
    yield "✅ Generation complete! Select a highlight to view.", gr.update(choices=clip_choices, value=clip_choices[0] if clip_choices else None, visible=True), clip_mapping, results
    
    


def display_highlight(clip_name, clip_mapping, descriptions):
    """Updates video display and text when a highlight is selected."""
    if not clip_name or (isinstance(clip_name, list) and len(clip_name) == 0):
        # Return only two outputs: video (None) and an error message.
        return None, "⚠️ Please select a highlight."
    
    # Ensure `clip_name` is a string
    if isinstance(clip_name, list):
        clip_name = clip_name[0]
    if not isinstance(clip_name, str):
        return None, "⚠️ Invalid selection."
    
    # Ensure `clip_mapping` is a dictionary
    if not isinstance(clip_mapping, dict):
        return None, "⚠️ Error: Clip mapping is missing."
    
    # Retrieve the correct video path
    if clip_name in clip_mapping:
        video_path = clip_mapping[clip_name]
        description_path = video_path.replace("clips_commented", "clips_tracked")
        description = descriptions.get(description_path, {}).get("Generated Commentary", "ℹ️ No description available.")
        print(video_path)
        print(description)
        return video_path, description

    return None, "❌ Selected highlight not found."


DESCRIPTIONS_OUTPUT = {'data/app_test/action/custom/1_720p.mkv/clips_tracked/clip_0_Corner.mp4': {'timestamp': '1 - 00:37', 'label': 'Corner', 'description': '**Time: 0s–1s**\n- The ball is in play near the corner flag. A player in a white jersey is controlling the ball, preparing to take a corner kick. Other players are positioned around the penalty area, ready to react.\n\n**1s–2s**\n- The player in the white jersey takes the corner kick, sending the ball into the penalty area. Opposing players in blue jerseys are positioned to defend against the cross.\n\n**2s–3s**\n- The ball is in mid-air, heading towards the goal. Players in blue jerseys are jumping and attempting to head the ball away from their goal.\n\n**3s–4s**\n- The ball is close to the goal line, with players in blue jerseys trying to clear it. The goalkeeper in a blue jersey is positioned near the goalpost, ready to make a save if necessary.\n\n**4s–5s**\n- The ball is cleared by a player in a blue jersey, who kicks it back into play. The ball is now in the midfield area, with players from both teams moving to regain control.\n\n**5s–6s**\n- The ball is passed by a player in a white jersey to a teammate near the center circle. The player in white is looking for an opportunity to advance the ball further.\n\n**6s–7s**\n- The player in white passes the ball to another teammate, who is positioned closer to the goal. The player in white is still in the process of moving forward.\n\n**7s–8s**\n- The player in white receives the pass and prepares to take a shot on goal. The goalkeeper in blue is positioned near the goalpost, ready to defend.\n\n**8s–9s**\n- The player in white takes a shot on goal. The ball is heading towards the goal, with the goalkeeper in blue attempting to make a save.\n\n**9s–10s**\n- The ball hits the crossbar and bounces back out of play. The goalkeeper in blue catches the ball, preventing it from entering the net. The players in white are disappointed, while the players in blue celebrate the successful clearance.'}, 'data/app_test/action/custom/1_720p.mkv/clips_tracked/clip_4_Throw-in.mp4': {'timestamp': '1 - 01:34', 'label': 'Throw-in', 'description': "**Time: 0s–1s**\n- A player wearing a blue jersey with the number 25 on the back is holding a soccer ball above his head. He appears to be preparing to throw the ball in.\n\n**1s–2s**\n- The player lowers the ball slightly and begins to move forward, indicating he is about to execute the throw-in.\n\n**2s–3s**\n- The player continues to walk while holding the ball, maintaining a steady pace towards the sideline where the throw-in will take place.\n\n**3s–4s**\n- The player reaches the sideline and throws the ball into the air, initiating the throw-in.\n\n**4s–5s**\n- The ball is thrown into the air, and players from both teams are positioned around the throw-in area, ready to react to the ball's trajectory.\n\n**5s–6s**\n- The ball descends towards the field, and players from the team in white jerseys begin to move towards the ball, anticipating a potential clearance or interception.\n\n**6s–7s**\n- The ball lands near the feet of a player in a white jersey, who appears to be preparing to control or pass the ball.\n\n**7s–8s**\n- The player in white gains possession of the ball and starts to dribble it away from the throw-in spot, moving towards the midfield.\n\n**8s–9s**\n- The player in white continues to dribble the ball, passing it to a teammate further up the field.\n\n**9s–10s**\n- The player in white passes the ball to another teammate, who is now in a better position to advance the play. The ball is passed quickly, and the opposing team in blue jerseys begins to defend against the advancing play."}, 'data/app_test/action/custom/1_720p.mkv/clips_tracked/clip_6_Throw-in.mp4': {'timestamp': '1 - 01:52', 'label': 'Throw-in', 'description': "### Detailed Analysis of the Video Clip\n\n#### Time: 0s–1s\n- **Player Action**: A player in a blue jersey (number 29) is preparing to take a throw-in. He is holding the ball with both hands above his head.\n- **Ball Movement**: The ball is stationary, held by the player.\n- **Team Roles**: The player is a defender, and he is preparing to throw the ball back into play.\n\n#### Time: 1s–2s\n- **Player Action**: The player in the blue jersey (number 29) begins to throw the ball. His arm is extended, and the ball is in motion.\n- **Ball Movement**: The ball is thrown forward, starting its trajectory towards the field.\n- **Team Roles**: The player's teammates in blue jerseys are positioned near the sideline, ready to receive the throw-in.\n\n#### Time: 2s–3s\n- **Player Action**: The player in the blue jersey (number 29) completes the throw-in. His arm is fully extended, and the ball is now traveling through the air.\n- **Ball Movement**: The ball is in mid-air, heading towards the field.\n- **Team Roles**: The player's teammates in blue jerseys remain in position, anticipating the throw-in.\n\n#### Time: 3s–4s\n- **Player Action**: The ball continues its flight after being thrown by the player in the blue jersey (number 29).\n- **Ball Movement**: The ball is still in the air, moving towards the field.\n- **Team Roles**: The player's teammates in blue jerseys are still positioned near the sideline, ready to receive the throw-in.\n\n#### Time: 4s–5s\n- **Player Action**: The ball reaches the field and lands near the center circle.\n- **Ball Movement**: The ball is now on the ground, and players from both teams are positioning themselves to gain possession.\n- **Team Roles**: The player in the blue jersey (number 29) has completed the throw-in, and the ball is now in play.\n\n#### Time: 5s–6s\n- **Player Action**: The ball is in play, and players from both teams are competing for possession.\n- **Ball Movement**: The ball is rolling across the field.\n- **Team Roles**: Players in white jerseys (opposing team) are defending, while players in blue jerseys (home team) are advancing.\n\n#### Time: 6s–7s\n- **Player Action**: A player in a white jersey (opposing team) gains control of the ball.\n- **Ball Movement**: The player in the white jersey dribbles the ball forward.\n- **Team Roles**: The player in the white jersey is advancing with the ball, while players in blue jerseys are tracking him.\n\n#### Time: 7s–8s\n- **Player Action**: The player in the white jersey continues to dribble the ball forward.\n- **Ball Movement**: The ball is being controlled by the player in the white jersey.\n- **Team Roles**: The player in the white jersey is advancing with the ball, while players in blue jerseys are tracking him.\n\n#### Time: 8s–9s\n- **Player Action**: The player in the white jersey passes the ball to a teammate.\n- **Ball Movement**: The ball is passed forward.\n- **Team Roles**: The player in the white jersey makes a pass, and the ball is now in the possession of another player in a white jersey.\n\n#### Time: 9s–10s\n- **Player Action**: The player in the white jersey receives the ball and continues to advance.\n- **Ball Movement**: The ball is being controlled by the player in the white jersey.\n- **Team Roles**: The player in the white jersey is advancing with the ball, while players in blue jerseys are tracking him.\n\n### Summary\nThe sequence shows a player in a blue jersey taking a throw-in and throwing the ball back into play. The ball travels through the air and lands near the center circle, where players from both teams compete for possession. The player in the white jersey gains control of the ball and starts advancing with it, passing it to a teammate who continues to move forward."}, 'data/app_test/action/custom/1_720p.mkv/clips_tracked/clip_7_Goal.mp4': {'timestamp': '1 - 02:07', 'label': 'Goal', 'description': '**Time: 0s–1s**\n- The ball is in play near the Tottenham Hotspur (TOTT) midfield area. A player in a white jersey (TOTT) is controlling the ball while being marked by a player in a blue jersey (CHE).\n\n**Time: 1s–2s**\n- The player in the white jersey passes the ball to a teammate positioned further upfield. The player in the blue jersey continues to track the movement of the ball.\n\n**Time: 2s–3s**\n- The white-jerseyed player receives the pass and dribbles forward, advancing towards the Chelsea (CHE) defense.\n\n**Time: 3s–4s**\n- The player in the white jersey continues to advance with the ball, evading the pressure from the blue-jerseyed defender.\n\n**Time: 4s–5s**\n- The white-jerseyed player makes a quick pass to another teammate who is positioned closer to the CHE goal.\n\n**Time: 5s–6s**\n- The teammate in the white jersey receives the pass and takes a shot at the CHE goal. The ball is directed towards the CHE goalkeeper.\n\n**Time: 6s–7s**\n- The CHE goalkeeper dives to make a save, but the ball goes past him into the net.\n\n**Time: 7s–8s**\n- The ball is now inside the CHE goal, and the TOTT players celebrate the goal. They run towards each other, hugging and cheering.\n\n**Time: 8s–9s**\n- The TOTT players continue to celebrate, with one player raising his arms in triumph.\n\n**Time: 9s–10s**\n- The TOTT players gather around, embracing each other in joy. The crowd in the background is also seen cheering enthusiastically.'}, 'data/app_test/action/custom/1_720p.mkv/clips_tracked/clip_8_Substitution.mp4': {'timestamp': '1 - 02:11', 'label': 'Substitution', 'description': "### Detailed Analysis of the Video Clip\n\n#### Time: 0s–1s\n- **Description**: The scene opens with a wide view of the pitch, showing Tottenham Hotspur players in white jerseys advancing towards Chelsea's goal. The ball is being passed around by Tottenham players, with one player in possession near the center of the field. The Chelsea defense, in blue jerseys, is positioned to intercept or defend against the attack. The crowd is visible in the background, adding to the atmosphere of the match.\n\n#### Time: 1s–2s\n- **Description**: The ball is now closer to the Chelsea penalty area. A Tottenham player in white is dribbling the ball while being closely marked by a Chelsea defender. The ball is moving quickly, and the player in white is trying to find a way through the defensive line.\n\n#### Time: 2s–3s\n- **Description**: The ball is now inside the Chelsea penalty area. A Tottenham player in white has managed to bypass the Chelsea defenders and is taking a shot at the goal. The goalkeeper in blue is preparing to make a save.\n\n#### Time: 3s–4s\n- **Description**: The ball is in mid-air, heading towards the goal. The Tottenham player who took the shot appears to have scored, as the ball goes past the goalkeeper. The crowd erupts in celebration.\n\n#### Time: 4s–5s\n- **Description**: The scene shifts to show Tottenham players celebrating the goal. Two players in white jerseys are hugging and cheering, clearly excited about the score. The camera focuses on their faces, showing their joy and relief.\n\n#### Time: 5s–6s\n- **Description**: The camera pans slightly to show another Tottenham player in white, also celebrating the goal. He is clapping his hands and looking towards the crowd, acknowledging their support.\n\n#### Time: 6s–7s\n- **Description**: The scene continues to focus on the Tottenham players celebrating. One player is seen running towards the corner flag, still in high spirits. The crowd is visible in the background, cheering loudly.\n\n#### Time: 7s–8s\n- **Description**: The camera captures a close-up of a Tottenham player in white, who is now walking away from the goal area. He appears to be catching his breath after the intense celebration.\n\n#### Time: 8s–9s\n- **Description**: Another Tottenham player in white is shown, this time looking towards the crowd. He seems to be acknowledging the fans' cheers, possibly giving a thumbs-up gesture.\n\n#### Time: 9s–10s\n- **Description**: The final frame shows a Tottenham player in white, who is now walking back towards the midfield. He appears to be composed and focused, likely preparing for the next phase of the game.\n\n### Summary\nThe video clip captures a crucial moment where Tottenham Hotspur scores a goal against Chelsea. The sequence starts with Tottenham players advancing towards the goal, followed by a successful shot that results in a goal. The celebration is evident as players hug and cheer, with the crowd responding enthusiastically. The final frames show the players regaining composure and preparing for the next part of the match."}, 'data/app_test/action/custom/1_720p.mkv/clips_tracked/clip_9_Throw-in.mp4': {'timestamp': '1 - 03:40', 'label': 'Throw-in', 'description': '**Time: 0s–1s**\n- The ball is thrown in by a player in a white jersey, likely from the corner flag area. The throw-in is directed towards the center of the field where players from both teams are positioned.\n\n**Time: 1s–2s**\n- The ball travels through the air, and players from both teams begin to move towards it. The player who threw the ball is now near the corner flag, preparing to receive the ball if it is returned.\n\n**Time: 2s–3s**\n- The ball lands near the center of the field, and players start to gather around it. The player in the white jersey who threw the ball is now moving back towards his own half.\n\n**Time: 3s–4s**\n- A player in a blue jersey gains possession of the ball after it lands. He starts to dribble forward, looking to pass or shoot.\n\n**Time: 4s–5s**\n- The player in the blue jersey passes the ball to a teammate who is positioned further up the field. The pass is made with precision, and the receiving player is ready to continue the play.\n\n**Time: 5s–6s**\n- The receiving player in the blue jersey controls the ball and begins to move forward, looking for an opportunity to pass or shoot. Other players from both teams are positioning themselves strategically.\n\n**Time: 6s–7s**\n- The player in the blue jersey continues to advance with the ball, passing it to another teammate who is also moving forward. The ball is passed quickly, and the receiving player is ready to make another move.\n\n**Time: 7s–8s**\n- The player in the blue jersey receives the ball again and continues to dribble forward, looking for an opening. Other players from both teams are closing in, trying to intercept the ball.\n\n**Time: 8s–9s**\n- The player in the blue jersey makes a quick pass to a teammate who is positioned on the wing. The pass is precise, and the receiving player is ready to take advantage of the space created.\n\n**Time: 9s–10s**\n- The player in the blue jersey who received the pass now has the ball and is looking to make a decision. He can either pass to another teammate or attempt a shot on goal. The goalkeeper and defenders from the opposing team are positioned to react accordingly.'}, 'data/app_test/action/custom/1_720p.mkv/clips_tracked/clip_10_Foul.mp4': {'timestamp': '1 - 04:31', 'label': 'Foul', 'description': "**Time: 0s–1s**\nA player in a blue jersey dribbles the ball forward while being closely marked by a player in a white jersey. The blue player is advancing towards the center of the field.\n\n**1s–2s**\nThe blue player continues to dribble, maintaining possession despite the pressure from the white-marked player. The ball is moving towards the midfield area.\n\n**2s–3s**\nThe blue player passes the ball to a teammate positioned further upfield. The pass is made with precision, aiming to create space for a potential attack.\n\n**3s–4s**\nThe ball is received by the teammate in the white jersey who is now in possession. The white team starts to organize their play, with players moving into strategic positions.\n\n**4s–5s**\nThe white team begins to distribute the ball among themselves, looking to build an attacking move. The blue team remains defensive, positioning themselves to intercept or challenge the white team's progress.\n\n**5s–6s**\nThe white team continues to pass the ball around, trying to find an opening. The blue team's defense remains compact, attempting to disrupt the white team's build-up.\n\n**6s–7s**\nThe white team advances the ball deeper into the blue team's half. The blue team's defense tightens, with players closing down spaces and preparing to regain control.\n\n**7s–8s**\nThe white team makes another pass, this time to a player on the wing. The blue team's right-back steps forward to intercept the ball, but the white player manages to maintain possession.\n\n**8s–9s**\nThe white player dribbles past the blue defender, advancing towards the penalty area. The blue team's goalkeeper and defenders position themselves to defend against any potential shot.\n\n**9s–10s**\nThe white player takes a shot at goal, but the ball is saved by the blue goalkeeper. The blue team regains possession and starts to counter-press the white team."}, 'data/app_test/action/custom/1_720p.mkv/clips_tracked/clip_12_Throw-in.mp4': {'timestamp': '1 - 06:21', 'label': 'Throw-in', 'description': '**Time: 0s–1s**\n- A player in a light blue jersey is seen walking on the field, likely preparing for the throw-in. The ball is not visible in these frames.\n\n**Time: 1s–2s**\n- The camera shifts to show a wider view of the field, revealing players from both teams positioned near the corner flag. The ball is not yet in play.\n\n**Time: 2s–3s**\n- The ball is thrown into the field by a player in a dark blue jersey. It travels through the air towards the corner area where the players are positioned.\n\n**Time: 3s–4s**\n- The ball lands near the corner flag, and players begin to move into position to receive or contest the throw-in.\n\n**Time: 4s–5s**\n- The ball is caught by a player in a dark blue jersey near the corner flag. This player appears to be preparing to throw the ball back into play.\n\n**Time: 5s–6s**\n- The player in the dark blue jersey throws the ball back into the field, aiming it towards the center of the pitch.\n\n**Time: 6s–7s**\n- The ball travels through the air, and players from both teams begin to move into position to contest possession.\n\n**Time: 7s–8s**\n- The ball lands near the center of the pitch, and players start to engage in the ensuing play.\n\n**Time: 8s–9s**\n- The ball is quickly contested by players from both teams, with one player in a dark blue jersey gaining control of the ball.\n\n**Time: 9s–10s**\n- The player in the dark blue jersey dribbles the ball forward, attempting to create space and advance the ball up the field.'}, 'data/app_test/action/custom/1_720p.mkv/clips_tracked/clip_13_Foul.mp4': {'timestamp': '1 - 06:33', 'label': 'Foul', 'description': "**Time: 0s–1s**\n- A player in a white jersey dribbles the ball forward while being closely marked by a player in a blue jersey. The white-jerseyed player is advancing towards the center of the field.\n\n**1s–2s**\n- The white-jerseyed player continues to dribble past the blue-jerseyed defender, maintaining possession of the ball. The ball is moving forward along the ground.\n\n**2s–3s**\n- The white-jerseyed player accelerates slightly, attempting to create space between himself and the blue-jerseyed defender. The ball is still close to his feet.\n\n**3s–4s**\n- The white-jerseyed player is now in a more open area of the field, with the blue-jerseyed defender still nearby. The ball is positioned near the player's right foot.\n\n**4s–5s**\n- The white-jerseyed player takes a quick touch with the ball, preparing to make a pass or continue dribbling. The blue-jerseyed defender is still within close proximity.\n\n**5s–6s**\n- The white-jerseyed player makes a slight turn, looking to either pass the ball or maintain control. The blue-jerseyed defender closes in, trying to intercept.\n\n**6s–7s**\n- The white-jerseyed player passes the ball to a teammate who is positioned further upfield. The blue-jerseyed defender is still in pursuit.\n\n**7s–8s**\n- The white-jerseyed player who received the pass is now in possession of the ball again, dribbling forward. The blue-jerseyed defender is still nearby, attempting to close down the space.\n\n**8s–9s**\n- The white-jerseyed player continues to dribble, looking to advance the ball deeper into the opponent's half. The blue-jerseyed defender is still in close pursuit.\n\n**9s–10s**\n- The white-jerseyed player is now in a more advanced position on the field, with the blue-jerseyed defender still nearby. The ball is close to the player's feet, indicating he is about to make another move."}, 'data/app_test/action/custom/1_720p.mkv/clips_tracked/clip_14_Foul.mp4': {'timestamp': '1 - 06:41', 'label': 'Foul', 'description': '**Time: 0s–1s**\nA player in a blue jersey dribbles the ball forward while being closely marked by a player in a white jersey. The blue player is advancing towards the center of the field.\n\n**1s–2s**\nThe blue player continues to dribble, maintaining control of the ball. The white-marking player is still in close pursuit, attempting to intercept or challenge.\n\n**2s–3s**\nThe blue player accelerates slightly, trying to create space between himself and the defender. The white player adjusts his position, preparing to tackle.\n\n**3s–4s**\nThe blue player passes the ball to a teammate positioned further upfield. The white player is still in close proximity, ready to react to the pass.\n\n**4s–5s**\nThe ball is now with the teammate who received it. He is facing away from the camera, looking to make a move or pass.\n\n**5s–6s**\nThe teammate in blue starts to dribble the ball again, looking to advance it further up the field. The white player is still marking him closely.\n\n**6s–7s**\nThe blue player continues to dribble, trying to find an opening. The white player is still in close pursuit, attempting to defend against the attack.\n\n**7s–8s**\nThe blue player passes the ball to another teammate who is positioned near the center of the field. The white player is still marking him, trying to prevent any progress.\n\n**8s–9s**\nThe new teammate in blue receives the ball and begins to dribble. The white player is still in close proximity, attempting to defend.\n\n**9s–10s**\nThe blue player continues to dribble, looking for an opportunity to pass or shoot. The white player is still marking him closely, trying to prevent any progress.\n\n**10s–11s**\nThe blue player passes the ball to a teammate who is positioned near the center of the field. The white player is still marking him, trying to defend.\n\n**11s–12s**\nThe new teammate in blue receives the ball and begins to dribble. The white player is still in close proximity, attempting to defend.\n\n**12s–13s**\nThe blue player continues to dribble, looking for an opportunity to pass or shoot. The white player is still marking him closely, trying to prevent any progress.\n\n**13s–14s**\nThe blue player passes the ball to a teammate who is positioned near the center of the field. The white player is still marking him, trying to defend.\n\n**14s–15s**\nThe new teammate in blue receives the ball and begins to dribble. The white player is still in close proximity, attempting to defend.\n\n**15s–16s**\nThe blue player continues to dribble, looking for an opportunity to pass or shoot. The white player is still marking him closely, trying to prevent any progress.\n\n**16s–17s**\nThe blue player passes the ball to a teammate who is positioned near the center of the field. The white player is still marking him, trying to defend.\n\n**17s–18s**\nThe new teammate in blue receives the ball and begins to dribble. The white player is still in close proximity, attempting to defend.\n\n**18s–19s**\nThe blue player continues to dribble, looking for an opportunity to pass or shoot. The white player is still marking him closely, trying to prevent any progress.\n\n**19s–20s**\nThe blue player passes the ball to a teammate who is positioned near the center of the field. The white player is still marking him, trying to defend.\n\n**20s–21s**\nThe new teammate in blue receives the ball and begins to dribble. The white player is still in close proximity, attempting to defend.\n\n**21s–22s**\nThe blue player continues to dribble, looking for an opportunity to pass or shoot. The white player is still marking him closely, trying to prevent any progress.\n\n**22s–23s**\nThe blue player passes the ball to a teammate who is positioned near the center of the field. The white player is still marking him, trying to defend.\n\n**23s–24s**\nThe new teammate in blue receives the ball and begins to dribble. The white player is still in close proximity, attempting to defend.\n\n**24s–25s**\nThe blue player continues to dribble, looking for an opportunity to pass or shoot. The white player is still marking him closely, trying to prevent any progress.\n\n**25s–26s**\nThe blue player passes the ball to a teammate who is positioned near the center of the field. The white player is still marking him, trying to defend.\n\n**26s–27s**\nThe new teammate in blue receives the ball and begins to dribble. The white player'}, 'data/app_test/action/custom/1_720p.mkv/clips_tracked/clip_15_Goal.mp4': {'timestamp': '1 - 07:48', 'label': 'Goal', 'description': "**Time: 0s–1s**\n- The ball is in play near the center of the field, with players from both teams positioned strategically. A player in a white jersey is seen controlling the ball, preparing to make a pass or move forward.\n\n**1s–2s**\n- The player in the white jersey passes the ball to a teammate who is positioned further upfield. The pass is quick and precise, indicating good teamwork and coordination.\n\n**2s–3s**\n- The teammate receives the ball and begins to dribble towards the opponent's goal. The ball is moving swiftly across the field, with the player maintaining control.\n\n**3s–4s**\n- As the player in the white jersey approaches the penalty area, they receive another pass from a teammate. The player continues to advance, looking for an opportunity to score.\n\n**4s–5s**\n- The player in the white jersey takes a shot at the goal. The ball is powerful and well-placed, heading towards the net.\n\n**5s–6s**\n- The goalkeeper in a blue jersey dives to make a save, but the ball goes past them. The ball enters the net, and the player in the white jersey celebrates by raising their arms in triumph.\n\n**6s–7s**\n- The player in the white jersey continues to celebrate, running towards the corner flag. The crowd in the background is cheering, adding to the excitement of the moment.\n\n**7s–8s**\n- The player in the white jersey is now near the corner flag, still celebrating. The camera focuses on their face, showing a look of joy and satisfaction.\n\n**8s–9s**\n- The player in the white jersey is now running back towards the center of the field, still celebrating. The camera follows their movement, capturing the energy of the moment.\n\n**9s–10s**\n- The player in the white jersey is now near the center of the field, still celebrating. The camera focuses on their face again, showing continued excitement and joy. The crowd continues to cheer in the background."}, 'data/app_test/action/custom/1_720p.mkv/clips_tracked/clip_16_Clearance.mp4': {'timestamp': '1 - 08:44', 'label': 'Clearance', 'description': "**Time: 0s–1s**\n- The ball is in the air near the center of the field, with players from both teams positioned around it. A player in a blue jersey (likely the goalkeeper) is preparing to clear the ball.\n\n**1s–2s**\n- The ball descends towards the ground, and a player in a white jersey (defender) jumps to head the ball away from their goal area. The ball is directed towards the right side of the field.\n\n**2s–3s**\n- The ball is now in the air again, heading towards the right side of the field. A player in a blue jersey (defender) is seen jumping to intercept or clear the ball.\n\n**3s–4s**\n- The ball lands on the ground near the sideline, and a player in a white jersey (defender) is seen controlling the ball with his foot. He appears to be preparing to pass the ball out of danger.\n\n**4s–5s**\n- The player in the white jersey passes the ball to a teammate further up the field. The ball travels quickly across the field, moving away from the goal area.\n\n**5s–6s**\n- The ball reaches a player in a white jersey who is running forward. This player seems to be advancing the ball towards midfield.\n\n**6s–7s**\n- The ball is now being controlled by a player in a white jersey who is dribbling it forward. He is surrounded by players in blue jerseys (defenders) attempting to challenge him.\n\n**7s–8s**\n- The player in the white jersey continues to dribble the ball, evading the defenders. He is making progress towards the opponent's half of the field.\n\n**8s–9s**\n- The ball is passed to another player in a white jersey who is now in possession. This player is advancing the ball further up the field, with defenders in blue jerseys following closely behind.\n\n**9s–10s**\n- The player in the white jersey continues to dribble the ball, maintaining control despite the pressure from the defenders. He is making significant progress towards the opponent's goal area."}, 'data/app_test/action/custom/1_720p.mkv/clips_tracked/clip_17_Clearance.mp4': {'timestamp': '1 - 08:46', 'label': 'Clearance', 'description': "**Time: 0s–1s**\n- The ball is in the air, heading towards the goal area. A player in a white jersey (Arsenal) is seen jumping to head the ball away from the goal. The goalkeeper in a blue jersey (Chelsea) is positioned near the goalpost, ready to react.\n\n**1s–2s**\n- The ball is now closer to the ground, and the player in the white jersey is still in mid-air, attempting to clear it. The goalkeeper in blue is slightly moving forward, anticipating the ball's trajectory.\n\n**2s–3s**\n- The ball has landed near the goal line, and players from both teams are converging around it. The player in the white jersey is on the ground, having just cleared the ball, while the goalkeeper in blue is also on the ground, having made a save attempt.\n\n**3s–4s**\n- The ball is now being contested by players from both teams near the goal line. The player in the white jersey is standing up, while the goalkeeper in blue is still on the ground, recovering from his save attempt.\n\n**4s–5s**\n- The ball is being passed or intercepted by a player in a blue jersey (Chelsea) who is now controlling it near the goal line. The player in the white jersey is moving back, likely preparing to defend.\n\n**5s–6s**\n- The player in the blue jersey is dribbling the ball away from the goal area, while players in white jerseys are positioning themselves to defend. The goalkeeper in blue is standing upright, observing the play.\n\n**6s–7s**\n- The player in the blue jersey continues to dribble the ball, passing it to a teammate further down the field. The players in white jerseys are closing in, trying to intercept the ball.\n\n**7s–8s**\n- The ball is now being passed between players in blue jerseys, advancing towards midfield. The players in white jerseys are still defending, maintaining their positions to prevent the opposing team from gaining possession.\n\n**8s–9s**\n- The ball is being passed again, with players in blue advancing deeper into the field. The players in white are still defending, with one player in white moving forward to intercept the ball.\n\n**9s–10s**\n- The ball is now being passed to a player in a blue jersey near the center of the field. The players in white are still defending, with one player in white moving forward to intercept the ball. The overall scene shows the ball being passed and defended as the game progresses."}, 'data/app_test/action/custom/1_720p.mkv/clips_tracked/clip_18_Kick-off.mp4': {'timestamp': '1 - 09:17', 'label': 'Kick-off', 'description': "### Detailed Analysis of the Video Clip\n\n#### Time: 0s–1s\n- **Description**: A player in a blue jersey with long hair is seen walking towards the center circle of the field. The crowd in the background is visible, indicating a live match setting.\n- **Player Action**: The player appears to be preparing for the kick-off, moving deliberately towards the center of the field.\n\n#### Time: 1s–2s\n- **Description**: The player in the blue jersey continues to walk, now closer to the center circle. Another player in a dark-colored outfit is seen nearby, likely a referee or another team member.\n- **Player Action**: The player in blue seems to be communicating or adjusting his position, possibly in preparation for the kick-off.\n\n#### Time: 2s–3s\n- **Description**: The camera shifts focus to the ground, showing the player's feet as he steps forward. The ball is not yet visible, suggesting the kick-off has not yet occurred.\n- **Player Action**: The player in blue takes a few steps, likely to position himself correctly for the kick-off.\n\n#### Time: 3s–4s\n- **Description**: The player in blue is now standing still, facing the center circle. His body posture suggests readiness for the kick-off.\n- **Player Action**: The player appears focused, possibly waiting for the referee's signal to begin the kick-off.\n\n#### Time: 4s–5s\n- **Description**: The camera angle changes slightly, showing the player's legs and the grassy field. The player's socks and shoes are clearly visible.\n- **Player Action**: The player remains stationary, maintaining his position near the center circle.\n\n#### Time: 5s–6s\n- **Description**: The player in blue is still positioned near the center circle, with no significant movement observed.\n- **Player Action**: The player appears to be waiting for the referee's signal to start the kick-off.\n\n#### Time: 6s–7s\n- **Description**: The camera focuses on the player's lower body, showing him standing still with his legs apart. The grass and the edge of the field are visible.\n- **Player Action**: The player maintains his position, indicating readiness for the kick-off.\n\n#### Time: 7s–8s\n- **Description**: The player in blue is still near the center circle, with no noticeable movement. The camera angle shows more of the field and the surrounding area.\n- **Player Action**: The player remains stationary, waiting for the kick-off to commence.\n\n#### Time: 8s–9s\n- **Description**: The player in blue is now seen from a different angle, closer to the center circle. He appears to be looking around, possibly checking his surroundings.\n- **Player Action**: The player seems to be mentally preparing for the kick-off, ensuring he is in the correct position.\n\n#### Time: 9s–10s\n- **Description**: The player in blue is now positioned very close to the center circle, with his body angled slightly forward. The camera captures a wider view of the field and the surrounding area.\n- **Player Action**: The player appears ready to receive the ball, with his body posture indicating anticipation for the kick-off.\n\n### Summary\nThe video clip captures the moments leading up to a kick-off in a soccer match. The player in the blue jersey is seen preparing for the kick-off, moving towards the center circle and positioning himself correctly. The sequence shows the player's deliberate movements and readiness, culminating in a moment where he is poised to receive the ball when the kick-off occurs."}, 'data/app_test/action/custom/1_720p.mkv/clips_tracked/clip_20_Clearance.mp4': {'timestamp': '1 - 10:05', 'label': 'Clearance', 'description': "**Time: 0s–1s**\n- The scene opens with a close-up of a coach on the sidelines, appearing frustrated or disappointed, with his hands on his head. The camera then cuts to a player in a white and blue jersey, likely a Chelsea player given the context, looking off to the side.\n\n**Time: 1s–2s**\n- The camera remains focused on the Chelsea player, who seems to be observing the field or reacting to something happening on the pitch.\n\n**Time: 2s–3s**\n- The scene transitions to a wide shot of the football field, showing players from both teams positioned across the pitch. The ball is near the center, and players are moving strategically.\n\n**Time: 3s–4s**\n- The ball is passed forward by a player in a dark-colored jersey, possibly Tottenham Hotspur, towards the midfield area. The camera follows the ball's movement.\n\n**Time: 4s–5s**\n- The ball reaches a player in a white and blue jersey, who appears to be advancing with the ball. The camera tracks the ball as it moves towards the opponent's half.\n\n**Time: 5s–6s**\n- The player in the white and blue jersey continues to dribble the ball, evading defenders in dark jerseys. The camera maintains focus on the ball and the player's movements.\n\n**Time: 6s–7s**\n- The ball is passed to another teammate in a white and blue jersey, who is now in possession. The camera follows the ball as it is passed again.\n\n**Time: 7s–8s**\n- The ball is received by a player in a white and blue jersey, who is now in a more advanced position closer to the opponent's goal. The camera continues to track the ball's movement.\n\n**Time: 8s–9s**\n- The player in the white and blue jersey makes a quick pass to a teammate, who is positioned near the edge of the penalty box. The camera follows the ball as it is passed.\n\n**Time: 9s–10s**\n- The ball is received by a player in a white and blue jersey, who is now in a good position to attempt a shot on goal. The camera focuses on the player preparing to take the shot.\n\n**Time: 10s–11s**\n- The player in the white and blue jersey takes a shot on goal. The ball is seen heading towards the goal, and the goalkeeper in a blue jersey dives to make a save.\n\n**Time: 11s–12s**\n- The ball is deflected by the goalkeeper, and the camera follows its trajectory as it bounces away from the goal area.\n\n**Time: 12s–13s**\n- The ball is cleared by a defender in a dark jersey, who kicks it out of the danger zone. The camera follows the ball as it is kicked away from the goal area.\n\n**Time: 13s–14s**\n- The ball is now in play again, and the camera shows players from both teams repositioning themselves on the field. The ball is seen moving back towards the midfield area.\n\n**Time: 14s–15s**\n- The ball is passed back to a player in a dark jersey, who is now in possession. The camera follows the ball as it is passed to a teammate.\n\n**Time: 15s–16s**\n- The ball is received by a player in a dark jersey, who is now in a good position to advance with the ball. The camera tracks the ball as it is passed.\n\n**Time: 16s–17s**\n- The ball is passed to another player in a dark jersey, who is now in a more advanced position. The camera follows the ball as it is moved further up the field.\n\n**Time: 17s–18s**\n- The ball is received by a player in a dark jersey, who is now in a good position to attempt a shot on goal. The camera focuses on the player preparing to take the shot.\n\n**Time: 18s–19s**\n- The player in the dark jersey takes a shot on goal. The ball is seen heading towards the goal, and the goalkeeper in a blue jersey dives to make a save.\n\n**Time: 19s–20s**\n- The ball is deflected by the goalkeeper, and the camera follows its trajectory as it bounces away from the goal area.\n\n**Time: 20s–21s**\n- The ball is cleared by a defender in a dark jersey, who kicks it out of the danger zone. The camera follows the ball as it is kicked away from the goal area.\n\n**Time: 21s–22s**\n- The ball is now in play again, and the camera shows players from both teams repositioning themselves on the field. The ball is seen moving back"}, 'data/app_test/action/custom/1_720p.mkv/clips_tracked/clip_21_Foul.mp4': {'timestamp': '1 - 11:00', 'label': 'Foul', 'description': "### Detailed Analysis of the Video Clip\n\n#### Time: 0s–1s\n- **Description**: The scene opens with a wide view of the field showing players from both teams positioned strategically. The ball is near the center of the pitch, and players are moving around, preparing for the next play. The player in the white and blue striped jersey appears to be advancing with the ball while being closely marked by players in blue jerseys.\n\n#### Time: 1s–2s\n- **Description**: The player in the white and blue striped jersey continues to dribble forward, maintaining possession of the ball. The blue team's defense is actively trying to intercept or challenge him.\n\n#### Time: 2s–3s\n- **Description**: As the player in the white and blue striped jersey advances, he is met by a challenge from a blue-uniformed player. The two players collide, causing the player in the white and blue striped jersey to lose control of the ball momentarily.\n\n#### Time: 3s–4s\n- **Description**: The player in the white and blue striped jersey stumbles and falls to the ground, losing possession of the ball. The blue-uniformed player who challenged him is now standing over him, appearing to be in a defensive stance.\n\n#### Time: 4s–5s\n- **Description**: The player in the white and blue striped jersey is lying on the ground, holding his leg, indicating he may have been fouled. The blue-uniformed player who challenged him is still standing nearby, looking towards the referee.\n\n#### Time: 5s–6s\n- **Description**: The referee, dressed in yellow, approaches the scene to assess the situation. Other players from both teams are watching the interaction closely, with some players in blue uniforms appearing concerned about their teammate's well-being.\n\n#### Time: 6s–7s\n- **Description**: The referee is now closer to the fallen player, observing the situation carefully. The player in the white and blue striped jersey remains on the ground, clutching his leg, while the blue-uniformed player who challenged him stands nearby, waiting for the referee's decision.\n\n#### Time: 7s–8s\n- **Description**: The referee makes a gesture, likely indicating a foul has occurred. The blue-uniformed player who challenged the player in the white and blue striped jersey steps back slightly, acknowledging the referee's decision.\n\n#### Time: 8s–9s\n- **Description**: The referee raises his hand, signaling a foul. The player in the white and blue striped jersey begins to get up from the ground, while the blue-uniformed player who challenged him also starts to move away from the scene.\n\n#### Time: 9s–10s\n- **Description**: The referee continues to gesture, confirming the foul. The player in the white and blue striped jersey is now standing, and the blue-uniformed player who challenged him is walking away, possibly to check on his own position on the field.\n\n### Summary\nThe sequence shows a clear foul occurring when a player in a white and blue striped jersey is challenged by a blue-uniformed player. The referee intervenes, confirms the foul, and the players react accordingly. The foul results in the player in the white and blue striped jersey falling to the ground, while the blue-uniformed player who challenged him steps back and acknowledges the referee's decision."}, 'data/app_test/action/custom/1_720p.mkv/clips_tracked/clip_22_Substitution.mp4': {'timestamp': '1 - 11:06', 'label': 'Substitution', 'description': "**Time: 0s–1s**\nA Tottenham player in a white jersey is lying on the ground after a tackle by a Chelsea player in a blue jersey. The Tottenham player appears to be injured, clutching his leg. Other players from both teams are nearby, observing the situation.\n\n**1s–2s**\nThe Tottenham player remains on the ground, still holding his leg. A Chelsea player in a blue jersey walks past him, seemingly unbothered. Another Chelsea player in a blue jersey with the number 8 on his back approaches the injured Tottenham player.\n\n**2s–3s**\nThe Chelsea player with the number 8 on his back bends down towards the Tottenham player, possibly checking on his condition or preparing to help him up. The Tottenham player continues to hold his leg.\n\n**3s–4s**\nThe Tottenham player is now being assisted by a Chelsea player in a blue jersey. The player in the blue jersey helps the Tottenham player to sit up slightly while other players from both teams continue to observe the scene.\n\n**4s–5s**\nThe Tottenham player is now sitting on the ground, supported by the Chelsea player in the blue jersey. The Tottenham player appears to be in pain, holding his leg tightly.\n\n**5s–6s**\nThe Tottenham player is now being helped off the field by a Tottenham coach or medical staff member. The player is still holding his leg, indicating ongoing discomfort.\n\n**6s–7s**\nThe Tottenham player is being carried off the field by the medical staff member. The player's teammates and opponents are watching the scene unfold.\n\n**7s–8s**\nThe Tottenham player is now being walked away from the field by the medical staff member. The player's teammates and opponents are still present, some looking concerned.\n\n**8s–9s**\nThe Tottenham player is now being guided off the field by the medical staff member. The player's teammates and opponents are still present, some looking concerned.\n\n**9s–10s**\nThe Tottenham player is now being walked off the field by the medical staff member. The player's teammates and opponents are still present, some looking concerned. The scene suggests a substitution is imminent as the player is being removed from the field due to injury."}, 'data/app_test/action/custom/1_720p.mkv/clips_tracked/clip_23_Substitution.mp4': {'timestamp': '1 - 11:08', 'label': 'Substitution', 'description': "**Time: 0s–1s**\nA player in a white Tottenham Hotspur jersey lies on the ground, seemingly injured. Another player in a blue Chelsea jersey walks past him, appearing concerned. A third player in a white jersey stands nearby, observing the situation.\n\n**1s–2s**\nThe player in the white Tottenham Hotspur jersey remains on the ground, while the player in the blue Chelsea jersey continues to walk away. The player in the white jersey bends down, possibly checking on his teammate or preparing to leave the field.\n\n**2s–3s**\nThe player in the white Tottenham Hotspur jersey is now being attended to by medical staff. He is lying on the ground with his head down, and a medical professional is bending over him, possibly assessing his condition.\n\n**3s–4s**\nThe player in the white Tottenham Hotspur jersey is still on the ground, and the medical professional continues to attend to him. Another individual, likely a coach or team staff member, approaches the scene.\n\n**4s–5s**\nThe player in the white Tottenham Hotspur jersey is now being helped off the field by two individuals, one of whom appears to be a coach or team staff member. The player is being supported as he walks away from the field.\n\n**5s–6s**\nThe player in the white Tottenham Hotspur jersey is being assisted by a coach or team staff member as he walks towards the sideline. The player's teammates and opponents are watching the situation unfold.\n\n**6s–7s**\nThe player in the white Tottenham Hotspur jersey is now being helped off the field by a coach or team staff member. The player is walking slowly, supported by the individual assisting him.\n\n**7s–8s**\nThe player in the white Tottenham Hotspur jersey is being helped off the field by a coach or team staff member. The player is walking slowly, supported by the individual assisting him. The player's teammates and opponents are watching the situation unfold.\n\n**8s–9s**\nThe player in the white Tottenham Hotspur jersey is now being helped off the field by a coach or team staff member. The player is walking slowly, supported by the individual assisting him. The player's teammates and opponents are watching the situation unfold.\n\n**9s–10s**\nThe player in the white Tottenham Hotspur jersey is being helped off the field by a coach or team staff member. The player is walking slowly, supported by the individual assisting him. The player's teammates and opponents are watching the situation unfold. The player in the white Tottenham Hotspur jersey is now being carried off the field by the medical staff."}, 'data/app_test/action/custom/1_720p.mkv/clips_tracked/clip_24_Substitution.mp4': {'timestamp': '1 - 11:39', 'label': 'Substitution', 'description': '**Time: 0s–1s**\n- A player in a teal goalkeeper uniform interacts with another individual near the sideline. The goalkeeper appears to be receiving instructions or a piece of equipment.\n- The individual assisting the goalkeeper is dressed in a dark blue puffer jacket.\n\n**Time: 1s–2s**\n- The goalkeeper bends slightly, possibly adjusting his gloves or preparing to receive further instructions.\n- The individual continues to gesture, likely giving directions or encouragement.\n\n**Time: 2s–3s**\n- The goalkeeper stands upright again, facing away from the camera, while the individual in the puffer jacket continues to gesture.\n\n**Time: 3s–4s**\n- The goalkeeper turns slightly towards the field, indicating readiness to return to the game.\n\n**Time: 4s–5s**\n- The goalkeeper walks away from the sideline, heading back onto the pitch.\n\n**Time: 5s–6s**\n- The scene shifts to show a player in a blue uniform standing on the field, preparing to take a free kick. The ball is positioned in front of him, and he appears focused.\n\n**Time: 6s–7s**\n- The player in blue takes a few steps back, positioning himself for the free kick. His body language suggests concentration and readiness.\n\n**Time: 7s–8s**\n- The player in blue stands still, maintaining his position, with the ball at his feet, ready to execute the free kick.\n\n**Time: 8s–9s**\n- The player in blue begins to take a few steps forward, preparing to strike the ball.\n\n**Time: 9s–10s**\n- The player in blue executes the free kick, sending the ball flying across the field.'}}

RESULTS_OUTPUT = {'data/app_test/action/custom/1_720p.mkv/clips_tracked/clip_0_Corner.mp4': {'Action': 'Corner', 'Raw Description': '**Time: 0s–1s**\n- The ball is in play near the corner flag. A player in a white jersey is controlling the ball, preparing to take a corner kick. Other players are positioned around the penalty area, ready to react.\n\n**1s–2s**\n- The player in the white jersey takes the corner kick, sending the ball into the penalty area. Opposing players in blue jerseys are positioned to defend against the cross.\n\n**2s–3s**\n- The ball is in mid-air, heading towards the goal. Players in blue jerseys are jumping and attempting to head the ball away from their goal.\n\n**3s–4s**\n- The ball is close to the goal line, with players in blue jerseys trying to clear it. The goalkeeper in a blue jersey is positioned near the goalpost, ready to make a save if necessary.\n\n**4s–5s**\n- The ball is cleared by a player in a blue jersey, who kicks it back into play. The ball is now in the midfield area, with players from both teams moving to regain control.\n\n**5s–6s**\n- The ball is passed by a player in a white jersey to a teammate near the center circle. The player in white is looking for an opportunity to advance the ball further.\n\n**6s–7s**\n- The player in white passes the ball to another teammate, who is positioned closer to the goal. The player in white is still in the process of moving forward.\n\n**7s–8s**\n- The player in white receives the pass and prepares to take a shot on goal. The goalkeeper in blue is positioned near the goalpost, ready to defend.\n\n**8s–9s**\n- The player in white takes a shot on goal. The ball is heading towards the goal, with the goalkeeper in blue attempting to make a save.\n\n**9s–10s**\n- The ball hits the crossbar and bounces back out of play. The goalkeeper in blue catches the ball, preventing it from entering the net. The players in white are disappointed, while the players in blue celebrate the successful clearance.', 'Generated Commentary': 'Right, here we go! \nA corner kick… the ball is in! \nIt’s whipped into the box – a scramble ensues! \nPlayers jumping, headers flying… what a challenge! \nCleared! The ball’s back in midfield – a quick pass… \nA shot! It’s… it’s off the bar! OH WOW!'}, 'data/app_test/action/custom/1_720p.mkv/clips_tracked/clip_4_Throw-in.mp4': {'Action': 'Throw-in', 'Raw Description': "**Time: 0s–1s**\n- A player wearing a blue jersey with the number 25 on the back is holding a soccer ball above his head. He appears to be preparing to throw the ball in.\n\n**1s–2s**\n- The player lowers the ball slightly and begins to move forward, indicating he is about to execute the throw-in.\n\n**2s–3s**\n- The player continues to walk while holding the ball, maintaining a steady pace towards the sideline where the throw-in will take place.\n\n**3s–4s**\n- The player reaches the sideline and throws the ball into the air, initiating the throw-in.\n\n**4s–5s**\n- The ball is thrown into the air, and players from both teams are positioned around the throw-in area, ready to react to the ball's trajectory.\n\n**5s–6s**\n- The ball descends towards the field, and players from the team in white jerseys begin to move towards the ball, anticipating a potential clearance or interception.\n\n**6s–7s**\n- The ball lands near the feet of a player in a white jersey, who appears to be preparing to control or pass the ball.\n\n**7s–8s**\n- The player in white gains possession of the ball and starts to dribble it away from the throw-in spot, moving towards the midfield.\n\n**8s–9s**\n- The player in white continues to dribble the ball, passing it to a teammate further up the field.\n\n**9s–10s**\n- The player in white passes the ball to another teammate, who is now in a better position to advance the play. The ball is passed quickly, and the opposing team in blue jerseys begins to defend against the advancing play.", 'Generated Commentary': 'Right, here we go! A throw-in… the blue player lifts the ball… he’s moving forward, preparing to launch it! *WHOOSH!* The ball flies into the air, a flurry of players around the area… it drops! A white jersey controls it brilliantly! He’s dribbling, passing… a quick exchange! The ball’s now with another white teammate, racing forward… defend!'}, 'data/app_test/action/custom/1_720p.mkv/clips_tracked/clip_6_Throw-in.mp4': {'Action': 'Throw-in', 'Raw Description': "### Detailed Analysis of the Video Clip\n\n#### Time: 0s–1s\n- **Player Action**: A player in a blue jersey (number 29) is preparing to take a throw-in. He is holding the ball with both hands above his head.\n- **Ball Movement**: The ball is stationary, held by the player.\n- **Team Roles**: The player is a defender, and he is preparing to throw the ball back into play.\n\n#### Time: 1s–2s\n- **Player Action**: The player in the blue jersey (number 29) begins to throw the ball. His arm is extended, and the ball is in motion.\n- **Ball Movement**: The ball is thrown forward, starting its trajectory towards the field.\n- **Team Roles**: The player's teammates in blue jerseys are positioned near the sideline, ready to receive the throw-in.\n\n#### Time: 2s–3s\n- **Player Action**: The player in the blue jersey (number 29) completes the throw-in. His arm is fully extended, and the ball is now traveling through the air.\n- **Ball Movement**: The ball is in mid-air, heading towards the field.\n- **Team Roles**: The player's teammates in blue jerseys remain in position, anticipating the throw-in.\n\n#### Time: 3s–4s\n- **Player Action**: The ball continues its flight after being thrown by the player in the blue jersey (number 29).\n- **Ball Movement**: The ball is still in the air, moving towards the field.\n- **Team Roles**: The player's teammates in blue jerseys are still positioned near the sideline, ready to receive the throw-in.\n\n#### Time: 4s–5s\n- **Player Action**: The ball reaches the field and lands near the center circle.\n- **Ball Movement**: The ball is now on the ground, and players from both teams are positioning themselves to gain possession.\n- **Team Roles**: The player in the blue jersey (number 29) has completed the throw-in, and the ball is now in play.\n\n#### Time: 5s–6s\n- **Player Action**: The ball is in play, and players from both teams are competing for possession.\n- **Ball Movement**: The ball is rolling across the field.\n- **Team Roles**: Players in white jerseys (opposing team) are defending, while players in blue jerseys (home team) are advancing.\n\n#### Time: 6s–7s\n- **Player Action**: A player in a white jersey (opposing team) gains control of the ball.\n- **Ball Movement**: The player in the white jersey dribbles the ball forward.\n- **Team Roles**: The player in the white jersey is advancing with the ball, while players in blue jerseys are tracking him.\n\n#### Time: 7s–8s\n- **Player Action**: The player in the white jersey continues to dribble the ball forward.\n- **Ball Movement**: The ball is being controlled by the player in the white jersey.\n- **Team Roles**: The player in the white jersey is advancing with the ball, while players in blue jerseys are tracking him.\n\n#### Time: 8s–9s\n- **Player Action**: The player in the white jersey passes the ball to a teammate.\n- **Ball Movement**: The ball is passed forward.\n- **Team Roles**: The player in the white jersey makes a pass, and the ball is now in the possession of another player in a white jersey.\n\n#### Time: 9s–10s\n- **Player Action**: The player in the white jersey receives the ball and continues to advance.\n- **Ball Movement**: The ball is being controlled by the player in the white jersey.\n- **Team Roles**: The player in the white jersey is advancing with the ball, while players in blue jerseys are tracking him.\n\n### Summary\nThe sequence shows a player in a blue jersey taking a throw-in and throwing the ball back into play. The ball travels through the air and lands near the center circle, where players from both teams compete for possession. The player in the white jersey gains control of the ball and starts advancing with it, passing it to a teammate who continues to move forward.", 'Generated Commentary': 'A blue jersey initiates the throw-in, a powerful arm extending… the ball soars! It’s traveling now, a beautiful arc… landing neatly near the center circle.  Players scramble, battling for possession… the white jersey takes control! He dribbles forward, a quick move… and passes!  He’s driving towards goal!'}, 'data/app_test/action/custom/1_720p.mkv/clips_tracked/clip_7_Goal.mp4': {'Action': 'Goal', 'Raw Description': '**Time: 0s–1s**\n- The ball is in play near the Tottenham Hotspur (TOTT) midfield area. A player in a white jersey (TOTT) is controlling the ball while being marked by a player in a blue jersey (CHE).\n\n**Time: 1s–2s**\n- The player in the white jersey passes the ball to a teammate positioned further upfield. The player in the blue jersey continues to track the movement of the ball.\n\n**Time: 2s–3s**\n- The white-jerseyed player receives the pass and dribbles forward, advancing towards the Chelsea (CHE) defense.\n\n**Time: 3s–4s**\n- The player in the white jersey continues to advance with the ball, evading the pressure from the blue-jerseyed defender.\n\n**Time: 4s–5s**\n- The white-jerseyed player makes a quick pass to another teammate who is positioned closer to the CHE goal.\n\n**Time: 5s–6s**\n- The teammate in the white jersey receives the pass and takes a shot at the CHE goal. The ball is directed towards the CHE goalkeeper.\n\n**Time: 6s–7s**\n- The CHE goalkeeper dives to make a save, but the ball goes past him into the net.\n\n**Time: 7s–8s**\n- The ball is now inside the CHE goal, and the TOTT players celebrate the goal. They run towards each other, hugging and cheering.\n\n**Time: 8s–9s**\n- The TOTT players continue to celebrate, with one player raising his arms in triumph.\n\n**Time: 9s–10s**\n- The TOTT players gather around, embracing each other in joy. The crowd in the background is also seen cheering enthusiastically.', 'Generated Commentary': 'The ball’s in motion, midfield clash between TOTT and CHE! A pass forward… a quick dribble, dodging the blue shirt! A clever pass to a teammate… he shoots! GOOAAAL!!! The keeper dives, but it’s in! TOTT celebrates, a joyous eruption from the crowd!'}, 'data/app_test/action/custom/1_720p.mkv/clips_tracked/clip_8_Substitution.mp4': {'Action': 'Substitution', 'Raw Description': "### Detailed Analysis of the Video Clip\n\n#### Time: 0s–1s\n- **Description**: The scene opens with a wide view of the pitch, showing Tottenham Hotspur players in white jerseys advancing towards Chelsea's goal. The ball is being passed around by Tottenham players, with one player in possession near the center of the field. The Chelsea defense, in blue jerseys, is positioned to intercept or defend against the attack. The crowd is visible in the background, adding to the atmosphere of the match.\n\n#### Time: 1s–2s\n- **Description**: The ball is now closer to the Chelsea penalty area. A Tottenham player in white is dribbling the ball while being closely marked by a Chelsea defender. The ball is moving quickly, and the player in white is trying to find a way through the defensive line.\n\n#### Time: 2s–3s\n- **Description**: The ball is now inside the Chelsea penalty area. A Tottenham player in white has managed to bypass the Chelsea defenders and is taking a shot at the goal. The goalkeeper in blue is preparing to make a save.\n\n#### Time: 3s–4s\n- **Description**: The ball is in mid-air, heading towards the goal. The Tottenham player who took the shot appears to have scored, as the ball goes past the goalkeeper. The crowd erupts in celebration.\n\n#### Time: 4s–5s\n- **Description**: The scene shifts to show Tottenham players celebrating the goal. Two players in white jerseys are hugging and cheering, clearly excited about the score. The camera focuses on their faces, showing their joy and relief.\n\n#### Time: 5s–6s\n- **Description**: The camera pans slightly to show another Tottenham player in white, also celebrating the goal. He is clapping his hands and looking towards the crowd, acknowledging their support.\n\n#### Time: 6s–7s\n- **Description**: The scene continues to focus on the Tottenham players celebrating. One player is seen running towards the corner flag, still in high spirits. The crowd is visible in the background, cheering loudly.\n\n#### Time: 7s–8s\n- **Description**: The camera captures a close-up of a Tottenham player in white, who is now walking away from the goal area. He appears to be catching his breath after the intense celebration.\n\n#### Time: 8s–9s\n- **Description**: Another Tottenham player in white is shown, this time looking towards the crowd. He seems to be acknowledging the fans' cheers, possibly giving a thumbs-up gesture.\n\n#### Time: 9s–10s\n- **Description**: The final frame shows a Tottenham player in white, who is now walking back towards the midfield. He appears to be composed and focused, likely preparing for the next phase of the game.\n\n### Summary\nThe video clip captures a crucial moment where Tottenham Hotspur scores a goal against Chelsea. The sequence starts with Tottenham players advancing towards the goal, followed by a successful shot that results in a goal. The celebration is evident as players hug and cheer, with the crowd responding enthusiastically. The final frames show the players regaining composure and preparing for the next part of the match.", 'Generated Commentary': 'The ball’s moving, Tottenham pressing! A shot… GOOAAAL! The keeper dives, but it’s past him! OH WOW! WHAT A STRIKE! The crowd erupts!!! Tottenham celebrating wildly! A fantastic effort!'}, 'data/app_test/action/custom/1_720p.mkv/clips_tracked/clip_9_Throw-in.mp4': {'Action': 'Throw-in', 'Raw Description': '**Time: 0s–1s**\n- The ball is thrown in by a player in a white jersey, likely from the corner flag area. The throw-in is directed towards the center of the field where players from both teams are positioned.\n\n**Time: 1s–2s**\n- The ball travels through the air, and players from both teams begin to move towards it. The player who threw the ball is now near the corner flag, preparing to receive the ball if it is returned.\n\n**Time: 2s–3s**\n- The ball lands near the center of the field, and players start to gather around it. The player in the white jersey who threw the ball is now moving back towards his own half.\n\n**Time: 3s–4s**\n- A player in a blue jersey gains possession of the ball after it lands. He starts to dribble forward, looking to pass or shoot.\n\n**Time: 4s–5s**\n- The player in the blue jersey passes the ball to a teammate who is positioned further up the field. The pass is made with precision, and the receiving player is ready to continue the play.\n\n**Time: 5s–6s**\n- The receiving player in the blue jersey controls the ball and begins to move forward, looking for an opportunity to pass or shoot. Other players from both teams are positioning themselves strategically.\n\n**Time: 6s–7s**\n- The player in the blue jersey continues to advance with the ball, passing it to another teammate who is also moving forward. The ball is passed quickly, and the receiving player is ready to make another move.\n\n**Time: 7s–8s**\n- The player in the blue jersey receives the ball again and continues to dribble forward, looking for an opening. Other players from both teams are closing in, trying to intercept the ball.\n\n**Time: 8s–9s**\n- The player in the blue jersey makes a quick pass to a teammate who is positioned on the wing. The pass is precise, and the receiving player is ready to take advantage of the space created.\n\n**Time: 9s–10s**\n- The player in the blue jersey who received the pass now has the ball and is looking to make a decision. He can either pass to another teammate or attempt a shot on goal. The goalkeeper and defenders from the opposing team are positioned to react accordingly.', 'Generated Commentary': 'The ball’s in! A throw-in from the corner… players surging forward, a real battle for possession! It lands right in the middle – a scramble begins! A blue jersey wins it, dribbling confidently! A precise pass, a teammate moving… they’re building momentum! Another quick pass to the wing! Now, he’s got space… he’s looking to shoot! GOOAALL!!!'}, 'data/app_test/action/custom/1_720p.mkv/clips_tracked/clip_10_Foul.mp4': {'Action': 'Foul', 'Raw Description': "**Time: 0s–1s**\nA player in a blue jersey dribbles the ball forward while being closely marked by a player in a white jersey. The blue player is advancing towards the center of the field.\n\n**1s–2s**\nThe blue player continues to dribble, maintaining possession despite the pressure from the white-marked player. The ball is moving towards the midfield area.\n\n**2s–3s**\nThe blue player passes the ball to a teammate positioned further upfield. The pass is made with precision, aiming to create space for a potential attack.\n\n**3s–4s**\nThe ball is received by the teammate in the white jersey who is now in possession. The white team starts to organize their play, with players moving into strategic positions.\n\n**4s–5s**\nThe white team begins to distribute the ball among themselves, looking to build an attacking move. The blue team remains defensive, positioning themselves to intercept or challenge the white team's progress.\n\n**5s–6s**\nThe white team continues to pass the ball around, trying to find an opening. The blue team's defense remains compact, attempting to disrupt the white team's build-up.\n\n**6s–7s**\nThe white team advances the ball deeper into the blue team's half. The blue team's defense tightens, with players closing down spaces and preparing to regain control.\n\n**7s–8s**\nThe white team makes another pass, this time to a player on the wing. The blue team's right-back steps forward to intercept the ball, but the white player manages to maintain possession.\n\n**8s–9s**\nThe white player dribbles past the blue defender, advancing towards the penalty area. The blue team's goalkeeper and defenders position themselves to defend against any potential shot.\n\n**9s–10s**\nThe white player takes a shot at goal, but the ball is saved by the blue goalkeeper. The blue team regains possession and starts to counter-press the white team.", 'Generated Commentary': 'The blue player dribbles, closely marked by white! \nThey keep possession, battling for midfield.\nA precise pass, creating space – brilliant!\nThe white team organizes, building an attack…\nThey pass, finding a winger, advancing quickly…\nThe white player shoots! \nGOOAAAL!!! The goalkeeper saves it!\nThe blue team reacts, counter-pressing immediately!'}, 'data/app_test/action/custom/1_720p.mkv/clips_tracked/clip_12_Throw-in.mp4': {'Action': 'Throw-in', 'Raw Description': '**Time: 0s–1s**\n- A player in a light blue jersey is seen walking on the field, likely preparing for the throw-in. The ball is not visible in these frames.\n\n**Time: 1s–2s**\n- The camera shifts to show a wider view of the field, revealing players from both teams positioned near the corner flag. The ball is not yet in play.\n\n**Time: 2s–3s**\n- The ball is thrown into the field by a player in a dark blue jersey. It travels through the air towards the corner area where the players are positioned.\n\n**Time: 3s–4s**\n- The ball lands near the corner flag, and players begin to move into position to receive or contest the throw-in.\n\n**Time: 4s–5s**\n- The ball is caught by a player in a dark blue jersey near the corner flag. This player appears to be preparing to throw the ball back into play.\n\n**Time: 5s–6s**\n- The player in the dark blue jersey throws the ball back into the field, aiming it towards the center of the pitch.\n\n**Time: 6s–7s**\n- The ball travels through the air, and players from both teams begin to move into position to contest possession.\n\n**Time: 7s–8s**\n- The ball lands near the center of the pitch, and players start to engage in the ensuing play.\n\n**Time: 8s–9s**\n- The ball is quickly contested by players from both teams, with one player in a dark blue jersey gaining control of the ball.\n\n**Time: 9s–10s**\n- The player in the dark blue jersey dribbles the ball forward, attempting to create space and advance the ball up the field.', 'Generated Commentary': 'Right then, we’re underway! A measured throw-in from Chelsea… the ball arcs through the air… players are shaping up… OH WOW! A clean catch by a Blues player near the flag… he’s launching it back! The ball’s soaring… players are surging forward… a fierce contest begins! The dark blue jersey gains control… he’s dribbling!'}, 'data/app_test/action/custom/1_720p.mkv/clips_tracked/clip_13_Foul.mp4': {'Action': 'Foul', 'Raw Description': "**Time: 0s–1s**\n- A player in a white jersey dribbles the ball forward while being closely marked by a player in a blue jersey. The white-jerseyed player is advancing towards the center of the field.\n\n**1s–2s**\n- The white-jerseyed player continues to dribble past the blue-jerseyed defender, maintaining possession of the ball. The ball is moving forward along the ground.\n\n**2s–3s**\n- The white-jerseyed player accelerates slightly, attempting to create space between himself and the blue-jerseyed defender. The ball is still close to his feet.\n\n**3s–4s**\n- The white-jerseyed player is now in a more open area of the field, with the blue-jerseyed defender still nearby. The ball is positioned near the player's right foot.\n\n**4s–5s**\n- The white-jerseyed player takes a quick touch with the ball, preparing to make a pass or continue dribbling. The blue-jerseyed defender is still within close proximity.\n\n**5s–6s**\n- The white-jerseyed player makes a slight turn, looking to either pass the ball or maintain control. The blue-jerseyed defender closes in, trying to intercept.\n\n**6s–7s**\n- The white-jerseyed player passes the ball to a teammate who is positioned further upfield. The blue-jerseyed defender is still in pursuit.\n\n**7s–8s**\n- The white-jerseyed player who received the pass is now in possession of the ball again, dribbling forward. The blue-jerseyed defender is still nearby, attempting to close down the space.\n\n**8s–9s**\n- The white-jerseyed player continues to dribble, looking to advance the ball deeper into the opponent's half. The blue-jerseyed defender is still in close pursuit.\n\n**9s–10s**\n- The white-jerseyed player is now in a more advanced position on the field, with the blue-jerseyed defender still nearby. The ball is close to the player's feet, indicating he is about to make another move.", 'Generated Commentary': 'White surges forward, battling the blue defender—a tense chase!\nHe’s gliding past, maintaining control of the ball.\nA quick acceleration, seeking more space now!\nThe ball’s close, right at his foot—a dangerous position.\nHe takes a touch, a subtle turn, passing to a teammate!\n'}, 'data/app_test/action/custom/1_720p.mkv/clips_tracked/clip_14_Foul.mp4': {'Action': 'Foul', 'Raw Description': '**Time: 0s–1s**\nA player in a blue jersey dribbles the ball forward while being closely marked by a player in a white jersey. The blue player is advancing towards the center of the field.\n\n**1s–2s**\nThe blue player continues to dribble, maintaining control of the ball. The white-marking player is still in close pursuit, attempting to intercept or challenge.\n\n**2s–3s**\nThe blue player accelerates slightly, trying to create space between himself and the defender. The white player adjusts his position, preparing to tackle.\n\n**3s–4s**\nThe blue player passes the ball to a teammate positioned further upfield. The white player is still in close proximity, ready to react to the pass.\n\n**4s–5s**\nThe ball is now with the teammate who received it. He is facing away from the camera, looking to make a move or pass.\n\n**5s–6s**\nThe teammate in blue starts to dribble the ball again, looking to advance it further up the field. The white player is still marking him closely.\n\n**6s–7s**\nThe blue player continues to dribble, trying to find an opening. The white player is still in close pursuit, attempting to defend against the attack.\n\n**7s–8s**\nThe blue player passes the ball to another teammate who is positioned near the center of the field. The white player is still marking him, trying to prevent any progress.\n\n**8s–9s**\nThe new teammate in blue receives the ball and begins to dribble. The white player is still in close proximity, attempting to defend.\n\n**9s–10s**\nThe blue player continues to dribble, looking for an opportunity to pass or shoot. The white player is still marking him closely, trying to prevent any progress.\n\n**10s–11s**\nThe blue player passes the ball to a teammate who is positioned near the center of the field. The white player is still marking him, trying to defend.\n\n**11s–12s**\nThe new teammate in blue receives the ball and begins to dribble. The white player is still in close proximity, attempting to defend.\n\n**12s–13s**\nThe blue player continues to dribble, looking for an opportunity to pass or shoot. The white player is still marking him closely, trying to prevent any progress.\n\n**13s–14s**\nThe blue player passes the ball to a teammate who is positioned near the center of the field. The white player is still marking him, trying to defend.\n\n**14s–15s**\nThe new teammate in blue receives the ball and begins to dribble. The white player is still in close proximity, attempting to defend.\n\n**15s–16s**\nThe blue player continues to dribble, looking for an opportunity to pass or shoot. The white player is still marking him closely, trying to prevent any progress.\n\n**16s–17s**\nThe blue player passes the ball to a teammate who is positioned near the center of the field. The white player is still marking him, trying to defend.\n\n**17s–18s**\nThe new teammate in blue receives the ball and begins to dribble. The white player is still in close proximity, attempting to defend.\n\n**18s–19s**\nThe blue player continues to dribble, looking for an opportunity to pass or shoot. The white player is still marking him closely, trying to prevent any progress.\n\n**19s–20s**\nThe blue player passes the ball to a teammate who is positioned near the center of the field. The white player is still marking him, trying to defend.\n\n**20s–21s**\nThe new teammate in blue receives the ball and begins to dribble. The white player is still in close proximity, attempting to defend.\n\n**21s–22s**\nThe blue player continues to dribble, looking for an opportunity to pass or shoot. The white player is still marking him closely, trying to prevent any progress.\n\n**22s–23s**\nThe blue player passes the ball to a teammate who is positioned near the center of the field. The white player is still marking him, trying to defend.\n\n**23s–24s**\nThe new teammate in blue receives the ball and begins to dribble. The white player is still in close proximity, attempting to defend.\n\n**24s–25s**\nThe blue player continues to dribble, looking for an opportunity to pass or shoot. The white player is still marking him closely, trying to prevent any progress.\n\n**25s–26s**\nThe blue player passes the ball to a teammate who is positioned near the center of the field. The white player is still marking him, trying to defend.\n\n**26s–27s**\nThe new teammate in blue receives the ball and begins to dribble. The white player', 'Generated Commentary': 'A blue player expertly dribbles, closely shadowed by a white marker! He accelerates, creating space—a clever pass to a teammate! Now, another blue player takes control, battling for position. The white defender presses, relentlessly tracking the movement! He passes again, searching for an opening… Oh wow! What a strike!'}, 'data/app_test/action/custom/1_720p.mkv/clips_tracked/clip_15_Goal.mp4': {'Action': 'Goal', 'Raw Description': "**Time: 0s–1s**\n- The ball is in play near the center of the field, with players from both teams positioned strategically. A player in a white jersey is seen controlling the ball, preparing to make a pass or move forward.\n\n**1s–2s**\n- The player in the white jersey passes the ball to a teammate who is positioned further upfield. The pass is quick and precise, indicating good teamwork and coordination.\n\n**2s–3s**\n- The teammate receives the ball and begins to dribble towards the opponent's goal. The ball is moving swiftly across the field, with the player maintaining control.\n\n**3s–4s**\n- As the player in the white jersey approaches the penalty area, they receive another pass from a teammate. The player continues to advance, looking for an opportunity to score.\n\n**4s–5s**\n- The player in the white jersey takes a shot at the goal. The ball is powerful and well-placed, heading towards the net.\n\n**5s–6s**\n- The goalkeeper in a blue jersey dives to make a save, but the ball goes past them. The ball enters the net, and the player in the white jersey celebrates by raising their arms in triumph.\n\n**6s–7s**\n- The player in the white jersey continues to celebrate, running towards the corner flag. The crowd in the background is cheering, adding to the excitement of the moment.\n\n**7s–8s**\n- The player in the white jersey is now near the corner flag, still celebrating. The camera focuses on their face, showing a look of joy and satisfaction.\n\n**8s–9s**\n- The player in the white jersey is now running back towards the center of the field, still celebrating. The camera follows their movement, capturing the energy of the moment.\n\n**9s–10s**\n- The player in the white jersey is now near the center of the field, still celebrating. The camera focuses on their face again, showing continued excitement and joy. The crowd continues to cheer in the background.", 'Generated Commentary': 'The ball’s in play, tension’s building… A swift pass!  The white jersey player dribbles forward, expertly controlling it.  Another pass, a shot! The goalkeeper dives… OH WOW! WHAT A STRIKE! The ball rockets into the net! GOOAALL!!! The white jersey player celebrates – pure joy! The crowd erupts with delight!'}, 'data/app_test/action/custom/1_720p.mkv/clips_tracked/clip_16_Clearance.mp4': {'Action': 'Clearance', 'Raw Description': "**Time: 0s–1s**\n- The ball is in the air near the center of the field, with players from both teams positioned around it. A player in a blue jersey (likely the goalkeeper) is preparing to clear the ball.\n\n**1s–2s**\n- The ball descends towards the ground, and a player in a white jersey (defender) jumps to head the ball away from their goal area. The ball is directed towards the right side of the field.\n\n**2s–3s**\n- The ball is now in the air again, heading towards the right side of the field. A player in a blue jersey (defender) is seen jumping to intercept or clear the ball.\n\n**3s–4s**\n- The ball lands on the ground near the sideline, and a player in a white jersey (defender) is seen controlling the ball with his foot. He appears to be preparing to pass the ball out of danger.\n\n**4s–5s**\n- The player in the white jersey passes the ball to a teammate further up the field. The ball travels quickly across the field, moving away from the goal area.\n\n**5s–6s**\n- The ball reaches a player in a white jersey who is running forward. This player seems to be advancing the ball towards midfield.\n\n**6s–7s**\n- The ball is now being controlled by a player in a white jersey who is dribbling it forward. He is surrounded by players in blue jerseys (defenders) attempting to challenge him.\n\n**7s–8s**\n- The player in the white jersey continues to dribble the ball, evading the defenders. He is making progress towards the opponent's half of the field.\n\n**8s–9s**\n- The ball is passed to another player in a white jersey who is now in possession. This player is advancing the ball further up the field, with defenders in blue jerseys following closely behind.\n\n**9s–10s**\n- The player in the white jersey continues to dribble the ball, maintaining control despite the pressure from the defenders. He is making significant progress towards the opponent's goal area.", 'Generated Commentary': 'The ball’s up, a tense moment here! A header’s coming… it’s headed away! \nThen, another aerial battle… a defender jumps! \nThe ball descends… a clearance attempt… it’s going right! \nA controlled touch, a pass launched… it’s flying! \nQuickly moving across the field… midfield bound! \nDribbling past challenges… he’s gaining ground!'}, 'data/app_test/action/custom/1_720p.mkv/clips_tracked/clip_17_Clearance.mp4': {'Action': 'Clearance', 'Raw Description': "**Time: 0s–1s**\n- The ball is in the air, heading towards the goal area. A player in a white jersey (Arsenal) is seen jumping to head the ball away from the goal. The goalkeeper in a blue jersey (Chelsea) is positioned near the goalpost, ready to react.\n\n**1s–2s**\n- The ball is now closer to the ground, and the player in the white jersey is still in mid-air, attempting to clear it. The goalkeeper in blue is slightly moving forward, anticipating the ball's trajectory.\n\n**2s–3s**\n- The ball has landed near the goal line, and players from both teams are converging around it. The player in the white jersey is on the ground, having just cleared the ball, while the goalkeeper in blue is also on the ground, having made a save attempt.\n\n**3s–4s**\n- The ball is now being contested by players from both teams near the goal line. The player in the white jersey is standing up, while the goalkeeper in blue is still on the ground, recovering from his save attempt.\n\n**4s–5s**\n- The ball is being passed or intercepted by a player in a blue jersey (Chelsea) who is now controlling it near the goal line. The player in the white jersey is moving back, likely preparing to defend.\n\n**5s–6s**\n- The player in the blue jersey is dribbling the ball away from the goal area, while players in white jerseys are positioning themselves to defend. The goalkeeper in blue is standing upright, observing the play.\n\n**6s–7s**\n- The player in the blue jersey continues to dribble the ball, passing it to a teammate further down the field. The players in white jerseys are closing in, trying to intercept the ball.\n\n**7s–8s**\n- The ball is now being passed between players in blue jerseys, advancing towards midfield. The players in white jerseys are still defending, maintaining their positions to prevent the opposing team from gaining possession.\n\n**8s–9s**\n- The ball is being passed again, with players in blue advancing deeper into the field. The players in white are still defending, with one player in white moving forward to intercept the ball.\n\n**9s–10s**\n- The ball is now being passed to a player in a blue jersey near the center of the field. The players in white are still defending, with one player in white moving forward to intercept the ball. The overall scene shows the ball being passed and defended as the game progresses.", 'Generated Commentary': 'The ball’s soaring! A white jersey leaps – a desperate header! The Chelsea keeper moves, anticipating… OH WOW! WHAT A STRIKE! The ball’s cleared! Players scramble… GOOAAAL! A close call there!'}, 'data/app_test/action/custom/1_720p.mkv/clips_tracked/clip_18_Kick-off.mp4': {'Action': 'Kick-off', 'Raw Description': "### Detailed Analysis of the Video Clip\n\n#### Time: 0s–1s\n- **Description**: A player in a blue jersey with long hair is seen walking towards the center circle of the field. The crowd in the background is visible, indicating a live match setting.\n- **Player Action**: The player appears to be preparing for the kick-off, moving deliberately towards the center of the field.\n\n#### Time: 1s–2s\n- **Description**: The player in the blue jersey continues to walk, now closer to the center circle. Another player in a dark-colored outfit is seen nearby, likely a referee or another team member.\n- **Player Action**: The player in blue seems to be communicating or adjusting his position, possibly in preparation for the kick-off.\n\n#### Time: 2s–3s\n- **Description**: The camera shifts focus to the ground, showing the player's feet as he steps forward. The ball is not yet visible, suggesting the kick-off has not yet occurred.\n- **Player Action**: The player in blue takes a few steps, likely to position himself correctly for the kick-off.\n\n#### Time: 3s–4s\n- **Description**: The player in blue is now standing still, facing the center circle. His body posture suggests readiness for the kick-off.\n- **Player Action**: The player appears focused, possibly waiting for the referee's signal to begin the kick-off.\n\n#### Time: 4s–5s\n- **Description**: The camera angle changes slightly, showing the player's legs and the grassy field. The player's socks and shoes are clearly visible.\n- **Player Action**: The player remains stationary, maintaining his position near the center circle.\n\n#### Time: 5s–6s\n- **Description**: The player in blue is still positioned near the center circle, with no significant movement observed.\n- **Player Action**: The player appears to be waiting for the referee's signal to start the kick-off.\n\n#### Time: 6s–7s\n- **Description**: The camera focuses on the player's lower body, showing him standing still with his legs apart. The grass and the edge of the field are visible.\n- **Player Action**: The player maintains his position, indicating readiness for the kick-off.\n\n#### Time: 7s–8s\n- **Description**: The player in blue is still near the center circle, with no noticeable movement. The camera angle shows more of the field and the surrounding area.\n- **Player Action**: The player remains stationary, waiting for the kick-off to commence.\n\n#### Time: 8s–9s\n- **Description**: The player in blue is now seen from a different angle, closer to the center circle. He appears to be looking around, possibly checking his surroundings.\n- **Player Action**: The player seems to be mentally preparing for the kick-off, ensuring he is in the correct position.\n\n#### Time: 9s–10s\n- **Description**: The player in blue is now positioned very close to the center circle, with his body angled slightly forward. The camera captures a wider view of the field and the surrounding area.\n- **Player Action**: The player appears ready to receive the ball, with his body posture indicating anticipation for the kick-off.\n\n### Summary\nThe video clip captures the moments leading up to a kick-off in a soccer match. The player in the blue jersey is seen preparing for the kick-off, moving towards the center circle and positioning himself correctly. The sequence shows the player's deliberate movements and readiness, culminating in a moment where he is poised to receive the ball when the kick-off occurs.", 'Generated Commentary': 'The blue player steps forward… he’s ready! He moves deliberately, focusing intently… OH WOW! WHAT A STRIKE! The crowd erupts!!! He’s poised, waiting… GOOAAAL!!!'}, 'data/app_test/action/custom/1_720p.mkv/clips_tracked/clip_20_Clearance.mp4': {'Action': 'Clearance', 'Raw Description': "**Time: 0s–1s**\n- The scene opens with a close-up of a coach on the sidelines, appearing frustrated or disappointed, with his hands on his head. The camera then cuts to a player in a white and blue jersey, likely a Chelsea player given the context, looking off to the side.\n\n**Time: 1s–2s**\n- The camera remains focused on the Chelsea player, who seems to be observing the field or reacting to something happening on the pitch.\n\n**Time: 2s–3s**\n- The scene transitions to a wide shot of the football field, showing players from both teams positioned across the pitch. The ball is near the center, and players are moving strategically.\n\n**Time: 3s–4s**\n- The ball is passed forward by a player in a dark-colored jersey, possibly Tottenham Hotspur, towards the midfield area. The camera follows the ball's movement.\n\n**Time: 4s–5s**\n- The ball reaches a player in a white and blue jersey, who appears to be advancing with the ball. The camera tracks the ball as it moves towards the opponent's half.\n\n**Time: 5s–6s**\n- The player in the white and blue jersey continues to dribble the ball, evading defenders in dark jerseys. The camera maintains focus on the ball and the player's movements.\n\n**Time: 6s–7s**\n- The ball is passed to another teammate in a white and blue jersey, who is now in possession. The camera follows the ball as it is passed again.\n\n**Time: 7s–8s**\n- The ball is received by a player in a white and blue jersey, who is now in a more advanced position closer to the opponent's goal. The camera continues to track the ball's movement.\n\n**Time: 8s–9s**\n- The player in the white and blue jersey makes a quick pass to a teammate, who is positioned near the edge of the penalty box. The camera follows the ball as it is passed.\n\n**Time: 9s–10s**\n- The ball is received by a player in a white and blue jersey, who is now in a good position to attempt a shot on goal. The camera focuses on the player preparing to take the shot.\n\n**Time: 10s–11s**\n- The player in the white and blue jersey takes a shot on goal. The ball is seen heading towards the goal, and the goalkeeper in a blue jersey dives to make a save.\n\n**Time: 11s–12s**\n- The ball is deflected by the goalkeeper, and the camera follows its trajectory as it bounces away from the goal area.\n\n**Time: 12s–13s**\n- The ball is cleared by a defender in a dark jersey, who kicks it out of the danger zone. The camera follows the ball as it is kicked away from the goal area.\n\n**Time: 13s–14s**\n- The ball is now in play again, and the camera shows players from both teams repositioning themselves on the field. The ball is seen moving back towards the midfield area.\n\n**Time: 14s–15s**\n- The ball is passed back to a player in a dark jersey, who is now in possession. The camera follows the ball as it is passed to a teammate.\n\n**Time: 15s–16s**\n- The ball is received by a player in a dark jersey, who is now in a good position to advance with the ball. The camera tracks the ball as it is passed.\n\n**Time: 16s–17s**\n- The ball is passed to another player in a dark jersey, who is now in a more advanced position. The camera follows the ball as it is moved further up the field.\n\n**Time: 17s–18s**\n- The ball is received by a player in a dark jersey, who is now in a good position to attempt a shot on goal. The camera focuses on the player preparing to take the shot.\n\n**Time: 18s–19s**\n- The player in the dark jersey takes a shot on goal. The ball is seen heading towards the goal, and the goalkeeper in a blue jersey dives to make a save.\n\n**Time: 19s–20s**\n- The ball is deflected by the goalkeeper, and the camera follows its trajectory as it bounces away from the goal area.\n\n**Time: 20s–21s**\n- The ball is cleared by a defender in a dark jersey, who kicks it out of the danger zone. The camera follows the ball as it is kicked away from the goal area.\n\n**Time: 21s–22s**\n- The ball is now in play again, and the camera shows players from both teams repositioning themselves on the field. The ball is seen moving back", 'Generated Commentary': "Frustration ripples through the sidelines... a Chelsea player, deep in thought. Then, a flurry of movement – players surging across the pitch! The ball’s whipped forward... a quick exchange... and a white and blue player bursts through!  He's dodging defenders, skillfully maneuvering…  A pass to another white and blue shirt!  Now, a beautiful through ball to a player in the attacking zone… he’s lining up the shot… **SHOOT!**  It’s flying…  The goalkeeper dives desperately…  **UNBELIEVABLE SAVE!!!**  The ball is cleared!\n"}, 'data/app_test/action/custom/1_720p.mkv/clips_tracked/clip_21_Foul.mp4': {'Action': 'Foul', 'Raw Description': "### Detailed Analysis of the Video Clip\n\n#### Time: 0s–1s\n- **Description**: The scene opens with a wide view of the field showing players from both teams positioned strategically. The ball is near the center of the pitch, and players are moving around, preparing for the next play. The player in the white and blue striped jersey appears to be advancing with the ball while being closely marked by players in blue jerseys.\n\n#### Time: 1s–2s\n- **Description**: The player in the white and blue striped jersey continues to dribble forward, maintaining possession of the ball. The blue team's defense is actively trying to intercept or challenge him.\n\n#### Time: 2s–3s\n- **Description**: As the player in the white and blue striped jersey advances, he is met by a challenge from a blue-uniformed player. The two players collide, causing the player in the white and blue striped jersey to lose control of the ball momentarily.\n\n#### Time: 3s–4s\n- **Description**: The player in the white and blue striped jersey stumbles and falls to the ground, losing possession of the ball. The blue-uniformed player who challenged him is now standing over him, appearing to be in a defensive stance.\n\n#### Time: 4s–5s\n- **Description**: The player in the white and blue striped jersey is lying on the ground, holding his leg, indicating he may have been fouled. The blue-uniformed player who challenged him is still standing nearby, looking towards the referee.\n\n#### Time: 5s–6s\n- **Description**: The referee, dressed in yellow, approaches the scene to assess the situation. Other players from both teams are watching the interaction closely, with some players in blue uniforms appearing concerned about their teammate's well-being.\n\n#### Time: 6s–7s\n- **Description**: The referee is now closer to the fallen player, observing the situation carefully. The player in the white and blue striped jersey remains on the ground, clutching his leg, while the blue-uniformed player who challenged him stands nearby, waiting for the referee's decision.\n\n#### Time: 7s–8s\n- **Description**: The referee makes a gesture, likely indicating a foul has occurred. The blue-uniformed player who challenged the player in the white and blue striped jersey steps back slightly, acknowledging the referee's decision.\n\n#### Time: 8s–9s\n- **Description**: The referee raises his hand, signaling a foul. The player in the white and blue striped jersey begins to get up from the ground, while the blue-uniformed player who challenged him also starts to move away from the scene.\n\n#### Time: 9s–10s\n- **Description**: The referee continues to gesture, confirming the foul. The player in the white and blue striped jersey is now standing, and the blue-uniformed player who challenged him is walking away, possibly to check on his own position on the field.\n\n### Summary\nThe sequence shows a clear foul occurring when a player in a white and blue striped jersey is challenged by a blue-uniformed player. The referee intervenes, confirms the foul, and the players react accordingly. The foul results in the player in the white and blue striped jersey falling to the ground, while the blue-uniformed player who challenged him steps back and acknowledges the referee's decision.", 'Generated Commentary': 'The tension is building! A challenge… a collision!  The white and blue striped jersey loses control… *OH WOW! WHAT A STRIKE!* The blue player closes in… a fall to the ground! The referee approaches – a clear foul! *GOOAAAL!!!*'}, 'data/app_test/action/custom/1_720p.mkv/clips_tracked/clip_22_Substitution.mp4': {'Action': 'Substitution', 'Raw Description': "**Time: 0s–1s**\nA Tottenham player in a white jersey is lying on the ground after a tackle by a Chelsea player in a blue jersey. The Tottenham player appears to be injured, clutching his leg. Other players from both teams are nearby, observing the situation.\n\n**1s–2s**\nThe Tottenham player remains on the ground, still holding his leg. A Chelsea player in a blue jersey walks past him, seemingly unbothered. Another Chelsea player in a blue jersey with the number 8 on his back approaches the injured Tottenham player.\n\n**2s–3s**\nThe Chelsea player with the number 8 on his back bends down towards the Tottenham player, possibly checking on his condition or preparing to help him up. The Tottenham player continues to hold his leg.\n\n**3s–4s**\nThe Tottenham player is now being assisted by a Chelsea player in a blue jersey. The player in the blue jersey helps the Tottenham player to sit up slightly while other players from both teams continue to observe the scene.\n\n**4s–5s**\nThe Tottenham player is now sitting on the ground, supported by the Chelsea player in the blue jersey. The Tottenham player appears to be in pain, holding his leg tightly.\n\n**5s–6s**\nThe Tottenham player is now being helped off the field by a Tottenham coach or medical staff member. The player is still holding his leg, indicating ongoing discomfort.\n\n**6s–7s**\nThe Tottenham player is being carried off the field by the medical staff member. The player's teammates and opponents are watching the scene unfold.\n\n**7s–8s**\nThe Tottenham player is now being walked away from the field by the medical staff member. The player's teammates and opponents are still present, some looking concerned.\n\n**8s–9s**\nThe Tottenham player is now being guided off the field by the medical staff member. The player's teammates and opponents are still present, some looking concerned.\n\n**9s–10s**\nThe Tottenham player is now being walked off the field by the medical staff member. The player's teammates and opponents are still present, some looking concerned. The scene suggests a substitution is imminent as the player is being removed from the field due to injury.", 'Generated Commentary': 'Uh oh, a tackle there! The Tottenham player goes down, clutching his leg – a concerning sight! A Chelsea player approaches, checking on him… He’s being assisted now, carefully helped to sit up. Medical staff are on the scene, swiftly helping him off the field. They’re carrying him away now, teammates watching with concern. Substitution incoming, it looks like!'}, 'data/app_test/action/custom/1_720p.mkv/clips_tracked/clip_23_Substitution.mp4': {'Action': 'Substitution', 'Raw Description': "**Time: 0s–1s**\nA player in a white Tottenham Hotspur jersey lies on the ground, seemingly injured. Another player in a blue Chelsea jersey walks past him, appearing concerned. A third player in a white jersey stands nearby, observing the situation.\n\n**1s–2s**\nThe player in the white Tottenham Hotspur jersey remains on the ground, while the player in the blue Chelsea jersey continues to walk away. The player in the white jersey bends down, possibly checking on his teammate or preparing to leave the field.\n\n**2s–3s**\nThe player in the white Tottenham Hotspur jersey is now being attended to by medical staff. He is lying on the ground with his head down, and a medical professional is bending over him, possibly assessing his condition.\n\n**3s–4s**\nThe player in the white Tottenham Hotspur jersey is still on the ground, and the medical professional continues to attend to him. Another individual, likely a coach or team staff member, approaches the scene.\n\n**4s–5s**\nThe player in the white Tottenham Hotspur jersey is now being helped off the field by two individuals, one of whom appears to be a coach or team staff member. The player is being supported as he walks away from the field.\n\n**5s–6s**\nThe player in the white Tottenham Hotspur jersey is being assisted by a coach or team staff member as he walks towards the sideline. The player's teammates and opponents are watching the situation unfold.\n\n**6s–7s**\nThe player in the white Tottenham Hotspur jersey is now being helped off the field by a coach or team staff member. The player is walking slowly, supported by the individual assisting him.\n\n**7s–8s**\nThe player in the white Tottenham Hotspur jersey is being helped off the field by a coach or team staff member. The player is walking slowly, supported by the individual assisting him. The player's teammates and opponents are watching the situation unfold.\n\n**8s–9s**\nThe player in the white Tottenham Hotspur jersey is now being helped off the field by a coach or team staff member. The player is walking slowly, supported by the individual assisting him. The player's teammates and opponents are watching the situation unfold.\n\n**9s–10s**\nThe player in the white Tottenham Hotspur jersey is being helped off the field by a coach or team staff member. The player is walking slowly, supported by the individual assisting him. The player's teammates and opponents are watching the situation unfold. The player in the white Tottenham Hotspur jersey is now being carried off the field by the medical staff.", 'Generated Commentary': 'Right, there he is – a Tottenham player down! \nAnother Chelsea player passes, showing concern. \nMedical staff rush onto the field immediately.\nHe’s being carefully attended to now.\nA coach assists him off the pitch slowly.\nThe player is being carried off – a tough moment for Spurs!'}, 'data/app_test/action/custom/1_720p.mkv/clips_tracked/clip_24_Substitution.mp4': {'Action': 'Substitution', 'Raw Description': '**Time: 0s–1s**\n- A player in a teal goalkeeper uniform interacts with another individual near the sideline. The goalkeeper appears to be receiving instructions or a piece of equipment.\n- The individual assisting the goalkeeper is dressed in a dark blue puffer jacket.\n\n**Time: 1s–2s**\n- The goalkeeper bends slightly, possibly adjusting his gloves or preparing to receive further instructions.\n- The individual continues to gesture, likely giving directions or encouragement.\n\n**Time: 2s–3s**\n- The goalkeeper stands upright again, facing away from the camera, while the individual in the puffer jacket continues to gesture.\n\n**Time: 3s–4s**\n- The goalkeeper turns slightly towards the field, indicating readiness to return to the game.\n\n**Time: 4s–5s**\n- The goalkeeper walks away from the sideline, heading back onto the pitch.\n\n**Time: 5s–6s**\n- The scene shifts to show a player in a blue uniform standing on the field, preparing to take a free kick. The ball is positioned in front of him, and he appears focused.\n\n**Time: 6s–7s**\n- The player in blue takes a few steps back, positioning himself for the free kick. His body language suggests concentration and readiness.\n\n**Time: 7s–8s**\n- The player in blue stands still, maintaining his position, with the ball at his feet, ready to execute the free kick.\n\n**Time: 8s–9s**\n- The player in blue begins to take a few steps forward, preparing to strike the ball.\n\n**Time: 9s–10s**\n- The player in blue executes the free kick, sending the ball flying across the field.', 'Generated Commentary': '“The goalkeeper’s getting a quick pep talk from his assistant – a crucial moment before returning to the action! Now, a Blue player steps up to take a free kick… he’s positioning himself perfectly… a few steps back… ready… GOOAAAL!”'}}

"""
if __name__ == "__main__":
    folder_name = "custom"
    video_name="1_720p.mkv"
    experiment, split = "action_sampling_weights_002", "test"
    game = folder_name + "/" + video_name
    constants.test_games = [game]
    prediction_dir = os.path.join("data", "app_test", "action/")

    clips_dir=os.path.join(prediction_dir, game, "clips")
    commentary_dir=os.path.join(prediction_dir, game, "clips_tracked", "commentary")
    output_dir=os.path.join(prediction_dir, game, "clips_commented")

    original_clips = [{'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_0_Corner.mp4', 'label': 'Corner', 'gameTime': '1 - 00:37'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_4_Throw-in.mp4', 'label': 'Throw-in', 'gameTime': '1 - 01:34'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_6_Throw-in.mp4', 'label': 'Throw-in', 'gameTime': '1 - 01:52'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_7_Goal.mp4', 'label': 'Goal', 'gameTime': '1 - 02:07'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_8_Substitution.mp4', 'label': 'Substitution', 'gameTime': '1 - 02:11'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_9_Throw-in.mp4', 'label': 'Throw-in', 'gameTime': '1 - 03:40'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_10_Foul.mp4', 'label': 'Foul', 'gameTime': '1 - 04:31'}, 
    {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_12_Throw-in.mp4', 'label': 'Throw-in', 'gameTime': '1 - 06:21'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_13_Foul.mp4', 'label': 'Foul', 'gameTime': '1 - 06:33'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_14_Foul.mp4', 'label': 'Foul', 'gameTime': '1 - 06:41'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_15_Goal.mp4', 'label': 'Goal', 'gameTime': '1 - 07:48'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_16_Clearance.mp4', 'label': 'Clearance', 'gameTime': '1 - 08:44'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_17_Clearance.mp4', 'label': 'Clearance', 'gameTime': '1 - 08:46'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_18_Kick-off.mp4', 'label': 'Kick-off', 'gameTime': '1 - 09:17'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_20_Clearance.mp4', 'label': 'Clearance', 'gameTime': '1 - 10:05'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_21_Foul.mp4', 'label': 'Foul', 'gameTime': '1 - 11:00'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_22_Substitution.mp4', 'label': 'Substitution', 'gameTime': '1 - 11:06'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_23_Substitution.mp4', 'label': 'Substitution', 'gameTime': '1 - 11:08'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_24_Substitution.mp4', 'label': 'Substitution', 'gameTime': '1 - 11:39'}]
    
    clips = [{"path": clip["path"].replace("clips", "clips_tracked"), "label": clip["label"], "gameTime": clip["gameTime"]} for clip in original_clips]
    
    ###################### DESCRIPTION GENERATION #######################
    match_context = "It's a Premier League match between Tottenham and Chelsea. Tottenham plays with white jerseys, and Chelsea plays with dark blue jerseys."
    descriptions = DESCRIPTIONS_OUTPUT
    
    
    # descriptions dictionary has the format: descriptions[clip["path"]] = {"timestamp": clip["gameTime"], "label": clip["label"], "description": description}
    ################### TEXTUAL COMMENTARY ###########################
    #results = generate_commentary(descriptions, match_context)
    results = RESULTS_OUTPUT
    print(results)
    for clip in clips:
       clip_path= clip["path"]
       generate_audio_commentary(clip_path, results[clip_path]["Generated Commentary"], clip['label'])
    
    merge_all_videos_with_audio(CLIPS_DIR=clips_dir, COMMENTARY_DIR=commentary_dir, OUTPUT_DIR=output_dir)
"""

"""
[{'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_0_Corner.mp4', 'label': 'Corner', 'gameTime': '1 - 00:37'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_1_Ball out of play.mp4', 'label': 'Ball out of play', 'gameTime': '1 - 00:43'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_2_Ball out of play.mp4', 'label': 'Ball out of play', 'gameTime': '1 - 01:06'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_3_Ball out of play.mp4', 'label': 'Ball out of play', 'gameTime': '1 - 01:10'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_4_Throw-in.mp4', 'label': 'Throw-in', 'gameTime': '1 - 01:34'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_5_Ball out of play.mp4', 'label': 'Ball out of play', 'gameTime': '1 - 01:38'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_6_Throw-in.mp4', 'label': 'Throw-in', 'gameTime': '1 - 01:52'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_7_Goal.mp4', 'label': 'Goal', 'gameTime': '1 - 02:07'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_8_Substitution.mp4', 'label': 'Substitution', 'gameTime': '1 - 02:11'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_9_Throw-in.mp4', 'label': 'Throw-in', 'gameTime': '1 - 03:40'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_10_Foul.mp4', 'label': 'Foul', 'gameTime': '1 - 04:31'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_11_Ball out of play.mp4', 'label': 'Ball out of play', 'gameTime': '1 - 06:06'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_12_Throw-in.mp4', 'label': 'Throw-in', 'gameTime': '1 - 06:21'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_13_Foul.mp4', 'label': 'Foul', 'gameTime': '1 - 06:33'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_14_Foul.mp4', 'label': 'Foul', 'gameTime': '1 - 06:41'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_15_Goal.mp4', 'label': 'Goal', 'gameTime': '1 - 07:48'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_16_Clearance.mp4', 'label': 'Clearance', 'gameTime': '1 - 08:44'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_17_Clearance.mp4', 'label': 'Clearance', 'gameTime': '1 - 08:46'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_18_Kick-off.mp4', 'label': 'Kick-off', 'gameTime': '1 - 09:17'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_19_Ball out of play.mp4', 'label': 'Ball out of play', 'gameTime': '1 - 09:39'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_20_Clearance.mp4', 'label': 'Clearance', 'gameTime': '1 - 10:05'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_21_Foul.mp4', 'label': 'Foul', 'gameTime': '1 - 11:00'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_22_Substitution.mp4', 'label': 'Substitution', 'gameTime': '1 - 11:06'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_23_Substitution.mp4', 'label': 'Substitution', 'gameTime': '1 - 11:08'}, {'path': 'data/app_test/action/custom/1_720p.mkv/clips/clip_24_Substitution.mp4', 'label': 'Substitution', 'gameTime': '1 - 11:39'}]
"""


with gr.Blocks() as app:
    gr.Markdown("# 🎥 AI-Powered Soccer Match Commentary")

    folder_dropdown = gr.Dropdown(choices=list_folders(), label="📂 Select a folder")
    video_dropdown = gr.Dropdown(label="🎥 Select a soccer match", choices=["No .mkv files available"]) #"Sélectionnez d'abord un dossier"

    folder_dropdown.change(fn=list_videos_in_folder, inputs=folder_dropdown, outputs=video_dropdown)

    start_button = gr.Button("🚀 Start Commentary Generation")
    output_textbox = gr.Textbox(label="Generation Status", interactive=False)

    # Dynamic Dropdown for Highlights (Hidden initially)
    highlights_dropdown = gr.Dropdown(label="📌 Select a Highlight", choices=["No available highlight"], visible=False)
    video_player = gr.Video(label="🎬 Highlight Clip", visible=False)
    description_textbox = gr.Textbox(label="📝 AI-Generated Commentary", visible=False)

    stored_clip_mapping = gr.State({})  
    stored_descriptions = gr.State({})

    start_button.click(fn=full_pipeline, inputs=[folder_dropdown, video_dropdown], outputs=[output_textbox, highlights_dropdown, stored_clip_mapping, stored_descriptions])
    highlights_dropdown.change(fn=display_highlight, inputs=[highlights_dropdown, stored_clip_mapping, stored_descriptions], outputs=[video_player, description_textbox])

    highlights_dropdown.change(lambda: gr.update(visible=True), outputs=highlights_dropdown)
    highlights_dropdown.change(lambda: gr.update(visible=True), outputs=video_player)
    highlights_dropdown.change(lambda: gr.update(visible=True), outputs=description_textbox)


if __name__ == "__main__":
    app.full_pipeline(server_name="0.0.0.0", server_port=7860, share=True)  # Modifier si besoin
